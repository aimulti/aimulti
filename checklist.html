<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë§ˆì¼€íŒ… 30ì¼ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
<style>
  /* ëª¨ë“  ìš”ì†Œì— box-sizing ì ìš© */
  * {
    box-sizing: border-box;
  }

  /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: #f4f7fa;
  padding-top: 112px; /* íƒ€ì´í‹€(56px) + í”„ë¡œê·¸ë ˆìŠ¤ë°”(56px) */
}

#header-title-fixed {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: white;
  z-index: 9999;
  border-bottom: 1px solid #e5e7eb;
  box-shadow: 0 2px 6px rgba(0,0,0,0.04);
  text-align: center;
  padding: 14px 0 8px 0;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
#header-title-fixed h1 {
  font-size: 1.7em;
  color: #2c3e50;
  margin: 0 0 0 24px;
  font-weight: bold;
  letter-spacing: 0.02em;
  display: block;
  opacity: 1;
}

/* ì•± ì œëª© (ìˆ˜ì • ê°€ëŠ¥) */
#app-title {
  font-size: 1.7em;
  color: #2c3e50;
  margin: 0 0 0 24px;
  font-weight: bold;
  letter-spacing: 0.02em;
  display: block;
  opacity: 1;
  cursor: text; /* í…ìŠ¤íŠ¸ í¸ì§‘ ì»¤ì„œ */
  outline: none; /* í¬ì»¤ìŠ¤ ì‹œ ì•„ì›ƒë¼ì¸ ì œê±° */
  min-width: 150px; /* í¸ì§‘ ì‹œ ìµœì†Œ ë„ˆë¹„ */
  padding: 2px 5px;
  border-radius: 4px;
}
#app-title:focus {
  background-color: #e0f2f7;
  box-shadow: 0 0 0 2px rgba(16,185,129,0.3);
}


.download-btn, .header-action-btn { /* ì¼ë°˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ í†µì¼ */
  background: none !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  color: #10b981;
  width: auto;
  height: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.7em;
  cursor: pointer;
  padding: 0 4px;
  border-radius: 0 !important;
  transition: color 0.2s;
}
.download-btn:hover, .header-action-btn:hover {
  color: #059669;
  background: none !important;
  border: none !important;
  box-shadow: none !important;
}

#share-buttons {
  Display: flex;
  Gap: 7px;
  Margin-right: 18px;
}

.share-btn {
background: none !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  color: #10b981;
  width: auto;
  height: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.7em;
  cursor: pointer;
  padding: 0 4px;
  border-radius: 0 !important;
}
.share-btn:hover {
  background: none !important;
  color: #059669;
  border: none !important;
  box-shadow: none !important;
}
#progress-container {
  position: fixed;
  top: 56px;
  left: 0;
  width: 100%;
  background-color: white;
  color: #2d6a4f;
  font-weight: bold;
  font-size: 1.1em;
  padding: 10px 16px 10px 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  z-index: 9998;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid #e5e7eb;
  height: 56px;
}
#progress-text {
  flex: 0 0 auto;
}
#progress-bar-bg {
  flex: 1 1 auto;
  background-color: #d1fae5;
  border-radius: 12px;
  height: 18px;
  margin-left: 15px;
  overflow: hidden;
  box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
}
#progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, #34d399, #059669);
  width: 0%;
  transition: width 0.3s ease;
  border-radius: 12px 0 0 12px;
}



  /* ì˜¤ë¥¸ìª½ í•˜ë‹¨ ê³ ì • ì›í˜• ì „ì²´ ì§„í–‰ë¥  */
  #circular-progress {
    position: relative;
    bottom: 20px;
    right: 20px;
    width: 100px; /* í¬ê¸° ì¦ê°€ */
    height: 100px; /* í¬ê¸° ì¦ê°€ */
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(16,185,129,0.4);
    pointer-events: none;
    transition: none;
  }

#circular-progress-wrapper {
  position: fixed;
  right: 0px;
  bottom: 0px;
  z-index: 2000;
  width: 100px;
  height: 100px;
  display: block;
  align-items: center;
  justify-content: center;
}

/* ë™ê·¸ë€ ì› */
#circular-progress {
  position: relative;
  width: 100px;
  height: 100px;
  z-index: 1;
}

/* ë§¨ ìœ„ë¡œ ë²„íŠ¼ì„ ì› ìœ„ì— ë„ìš°ê¸° */
#scroll-to-top-btn {
  position: absolute;
  right: -10px;
  /* ì¤‘ì•™ì´ ì•„ë‹ˆë¼, ì›ì˜ ìœ„ìª½ì— ë¶™ì´ê¸°: */
  top: -80px; /* ë²„íŠ¼ í¬ê¸°/ì› í¬ê¸°ì— ë”°ë¼ ì¡°ì •(56px ë²„íŠ¼ì¼ ë•Œ -28pxì´ ìœ„ì— ë”± ë¶™ìŒ) */
  transform: translate(-50%, 0);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #34d399 60%, #059669 100%);
  color: white;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(16,185,129,0.35);
  cursor: pointer;
  z-index: 2;
  transition: background 0.2s, box-shadow 0.2s, opacity 0.3s;
  font-size: 1.5em;
  opacity: 0.93;
  pointer-events: auto;
  overflow: hidden;
}

#scroll-to-top-btn .material-icons {
  font-size: 2em;
  display: block;
  margin: 0;
  line-height: 1;
  width: 1em;
  height: 1em;
  text-align: center;
  vertical-align: middle;
}

#scroll-to-top-btn.hide {
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
}
#scroll-to-top-btn:hover {
  background: linear-gradient(135deg, #059669 60%, #34d399 100%);
  box-shadow: 0 8px 18px rgba(16,185,129,0.48);
  opacity: 1;
}

/* ëª¨ë°”ì¼ ëŒ€ì‘ */
@media (max-width: 768px) {
  #circular-progress-wrapper {
    right: 0px;
    bottom: 110px;
    width: 70px;
    height: 70px;
  }
  #circular-progress {
    width: 70px;
    height: 70px;
  }
  #circular-progress svg {
    width: 70px;
    height: 70px;
  }
  #scroll-to-top-btn {
    width: 30px;
    height: 30px;
    font-size: 1.1em;
    top: -70px; /* ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ì´ ì› ìœ„ì— ì˜ ë¶™ë„ë¡ ì¡°ì • */
    Right: 0px;
  }
}

  .circular-svg {
    width: 100%; /* ë¶€ëª¨ divì— ë§ì¶° ì¡°ì ˆ */
    height: 100; /* ë¶€ëª¨ divì— ë§ì¶° ì¡°ì ˆ */
    Display: block;
  }
  .circular-bg {
    stroke: #ffffff;
    stroke-width: 10; /* ì„  êµµê¸° ì¦ê°€ */
    fill: none;
  }
  .circular-fg {
    stroke: url(#circular-gradient);
    stroke-width: 10; /* ì„  êµµê¸° ì¦ê°€ */
    /* stroke-linecap: round;  <-- ì´ ë¶€ë¶„ì„ ì œê±°í•©ë‹ˆë‹¤. */
    transition: stroke-dashoffset 0.5s cubic-bezier(.4,2,.6,1);
    transform: rotate(-90deg);
    transform-origin: 50% 50%; /* ì¤‘ì•™ ê¸°ì¤€ìœ¼ë¡œ íšŒì „ */
    fill: none;
  }
  .circular-text {
    font-size: 1.8em; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
    fill: #10b981;
    font-weight: bold;
    font-family: 'Arial', sans-serif;
    pointer-events: none;
    user-select: none;
    /* SVG ë‚´ë¶€ í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
    dominant-baseline: middle;
    alignment-baseline: middle;
    text-anchor: middle;
  }
  .circular-label {
    font-size: 1.2em; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
    fill: #10b981;
    font-family: 'Arial', sans-serif;
    font-weight: bold;
    pointer-events: none;
    user-select: none;
    /* SVG ë‚´ë¶€ í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
    dominant-baseline: middle;
    alignment-baseline: middle;
    text-anchor: middle;
  }
  h1 { display: none; } /* í˜ì´ì§€ ì œëª©ì€ ê³ ì • í—¤ë”ì—ë§Œ í‘œì‹œ */

  /* ì²´í¬ë¦¬ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ - ê°€ë¡œ ìŠ¤í¬ë¡¤ ë° ë“œë˜ê·¸ */
  #checklist-wrapper {
    position: relative; /* í™”ì‚´í‘œ ë²„íŠ¼ ìœ„ì¹˜ ì§€ì •ì„ ìœ„í•´ ì¶”ê°€ */
    padding-bottom: 20px; /* ìŠ¤í¬ë¡¤ë°” ê³µê°„ í™•ë³´ */
  }

  #checklist {
    display: flex; /* í”Œë ‰ìŠ¤ ë°•ìŠ¤ */
    overflow-x: auto; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
    scroll-snap-type: x mandatory; /* ì¹´ë“œ ìŠ¤ëƒ… íš¨ê³¼ */
    -webkit-overflow-scrolling: touch; /* iOS ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ */
    scrollbar-width: thin; /* Firefox ìŠ¤í¬ë¡¤ë°” */
    scrollbar-color: #34d399 #e5e7eb; /* Firefox ìŠ¤í¬ë¡¤ë°” ìƒ‰ìƒ */
    cursor: grab; /* ë“œë˜ê·¸ ê°€ëŠ¥í•œ ì»¤ì„œ */
  }
  #checklist.grabbing {
    cursor: grabbing; /* ë“œë˜ê·¸ ì¤‘ ì»¤ì„œ */
  }
  #checklist::-webkit-scrollbar {
    height: 8px;
  }
  #checklist::-webkit-scrollbar-track {
    background: #e5e7eb;
    border-radius: 10px;
  }
  #checklist::-webkit-scrollbar-thumb {
    background: #34d399;
    border-radius: 10px;
  }
  #checklist::-webkit-scrollbar-thumb:hover {
    background: #059669;
  }

  /* ì¹´í…Œê³ ë¦¬ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
  .category-box {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    margin-right: 20px; /* ì¹´ë“œ ê°„ ê°„ê²© */
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    border: 1px solid #e0e0e0;
    min-width: 320px; /* PC ê¸°ë³¸ ì¹´ë“œ ë„ˆë¹„ */
    flex: 0 0 auto; /* í”Œë ‰ìŠ¤ ì•„ì´í…œì´ ì¶•ì†Œë˜ì§€ ì•Šë„ë¡ ì„¤ì • */
    scroll-snap-align: start; /* ì¹´ë“œ ì‹œì‘ ì§€ì ì— ìŠ¤ëƒ… */
    max-width: 400px; /* PCì—ì„œ ë„ˆë¬´ ë„“ì–´ì§€ì§€ ì•Šë„ë¡ ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
    display: flex; /* ë‚´ë¶€ ìš”ì†Œ ì •ë ¬ */
    flex-direction: column; /* ì„¸ë¡œ ì •ë ¬ */
  }

  /* ë§ˆì§€ë§‰ ì¹´ë“œ margin-right ì œê±° */
  #checklist > .category-box:last-child {
    margin-right: 0;
  }

  .category-box h2 {
    color: #1a4d2e;
    font-size: 1.6em;
    margin-top: 0;
    margin-bottom: 15px;
    border-bottom: 2px solid #a7d9b5;
    padding-bottom: 8px;
    display: flex;
    align-items: center;
    font-weight: bold;
    justify-content: space-between; /* ì•„ì´ì½˜ê³¼ ì œëª© ê°„ê²© ì¡°ì • */
  }
  .category-box h2 .material-icons { /* Material Icons ìŠ¤íƒ€ì¼ */
    margin-right: 8px;
    color: #2d6a4f;
    font-size: 1.2em;
  }

  .category-actions {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .edit-category-btn, .delete-category-btn {
    color: #10b981;
    cursor: pointer;
    font-size: 1em;
    margin-left: 5px; /* ì•„ì´ì½˜ ì‚¬ì´ ê°„ê²© */
    transition: color 0.2s;
  }
  .edit-category-btn:hover {
    color: #059669;
  }
  .delete-category-btn {
    color: #e63946;
  }
  .delete-category-btn:hover {
    color: #d62828;
  }


  .day-section {
    background: #fdfdfd;
    border-radius: 8px;
    padding: 15px 20px;
    margin-bottom: 12px;
    box-shadow: 0 1px 5px rgba(0,0,0,0.05);
    position: relative;
    border: 1px solid #edf2f7;
  }
  .day-section h3 {
    color: #34495e;
    font-size: 1.1em;
    margin-top: 0;
    margin-bottom: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
  }
  .day-section h3 .day-actions { /* Day ì•¡ì…˜ ë²„íŠ¼ë“¤ì„ ìœ„í•œ ì»¨í…Œì´ë„ˆ */
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .day-section h3 .edit-day-btn { /* Day ìˆ˜ì • ë²„íŠ¼ */
    color: #10b981;
    cursor: pointer;
    font-size: 1em;
    transition: color 0.2s;
  }
  .day-section h3 .edit-day-btn:hover {
    color: #059669;
  }
  .day-section h3 .delete-day-btn {
    color: #e63946;
    cursor: pointer;
    font-size: 1em;
    transition: color 0.2s;
  }
  .day-section h3 .delete-day-btn:hover {
    color: #d62828;
  }
  .day-progress-text {
    font-size: 0.9em;
    color: #2d6a4f;
    font-weight: 600;
    min-width: 40px;
    text-align: right;
    margin-left: 10px;
  }
  .day-progress-bar-bg {
    width: 100%;
    height: 10px;
    background-color: transparent;
    border: 1.5px solid #d1fae5;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: none;
    margin: 6px 0 10px 0;
  }
  .day-progress-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #6ee7b7, #10b981);
    width: 0%;
    transition: width 0.3s ease;
    border-radius: 10px 0 0 10px;
  }
  ul {
    padding-left: 0; /* ì²´í¬ë°•ìŠ¤ ì •ë ¬ì„ ìœ„í•´ 0pxë¡œ ì„¤ì • */
    margin: 0;
    list-style: none; /* ê¸°ë³¸ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ì œê±° */
  }
  li {
    margin-bottom: 8px;
    font-size: 0.95em;
    transition: all 0.2s ease-in-out;
    display: flex; /* ì²´í¬ë°•ìŠ¤ì™€ í…ìŠ¤íŠ¸ë¥¼ í•œ ì¤„ì— ì •ë ¬ */
    align-items: center;
    justify-content: flex-start;
    position: relative; /* ë²„íŠ¼ ìœ„ì¹˜ ì§€ì •ì„ ìœ„í•´ */
    padding-left: 28px; /* +.ì²´í¬ë°•ìŠ¤ ê³µê°„ í™•ë³´ */
  }
  li:hover {
    background-color: #f0f8ff;
    border-radius: 6px;
  }

  /* íƒœìŠ¤í¬ í…ìŠ¤íŠ¸ì™€ ì•¡ì…˜ ë²„íŠ¼ì„ ê°ì‹¸ëŠ” div */
  .task-content-wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-grow: 1; /* ë‚¨ì€ ê³µê°„ ëª¨ë‘ ì°¨ì§€ */
  }

  /* ì»¤ìŠ¤í…€ ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
  input[type="checkbox"] {
    opacity: 0; /* ê¸°ë³¸ ì²´í¬ë°•ìŠ¤ ìˆ¨ê¸°ê¸° */
    position: absolute;
    z-index: -1; /* ë‹¤ë¥¸ ìš”ì†Œì— ê°€ë ¤ì§€ì§€ ì•Šë„ë¡ */
  }
  input[type="checkbox"] + span::before { /* ì²´í¬ë°•ìŠ¤ ëŒ€ì‹  í‘œì‹œë  ìš”ì†Œ */
    content: '';
    display: inline-block;
    width: 1.2em;
    height: 1.2em;
    flex-shrink: 0; /* í¬ê¸° ê³ ì • */
    flex-grow: 0;
    border: 2px solid #ccc;
    border-radius: 4px;
    margin-right: 0.5em;
    vertical-align: middle;
    transition: background-color 0.2s, border-color 0.2s;
    background-color: #f0f0f0;
  }
  input[type="checkbox"]:checked + span::before {
    background-color: #34d399; /* ì²´í¬ ì‹œ ë°°ê²½ìƒ‰ */
    border-color: #34d399; /* ì²´í¬ ì‹œ í…Œë‘ë¦¬ìƒ‰ */
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.207 4.793a1 1 0 011.414 0l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414l3.293 3.293 7.293-7.293a1 1 0 010 1.414z'/%3E%3C/svg%3E"); /* ì²´í¬ ì•„ì´ì½˜ (í°ìƒ‰) */
    background-repeat: no-repeat;
    background-position: center;
    background-size: 80%;
  }
  input[type="checkbox"]:focus + span::before {
    box_shadow: 0 0 0 3px rgba(52, 211, 153, 0.5); /* í¬ì»¤ìŠ¤ ì‹œ ì•„ì›ƒë¼ì¸ */
  }

  label {
    display: flex; /* í…ìŠ¤íŠ¸ì™€ ì²´í¬ë°•ìŠ¤ë¥¼ í•œ ì¤„ì— ì •ë ¬ */
    align-items: center;
    cursor: pointer;
    padding: 2px 0;
    flex-grow: 1; /* ë¼ë²¨ì´ ê°€ëŠ¥í•œ ê³µê°„ì„ ëª¨ë‘ ì°¨ì§€í•˜ë„ë¡ */
  }
  label:hover {
    background-color: #f0f8ff;
    border-radius: 6px;
    padding: 2px 4px;
  }
  .checked {
    text-decoration: line-through;
    color: #aaa;
  }

  .edit-task-input {
    width: calc(100% - 2em); /* ì²´í¬ë°•ìŠ¤ ê³µê°„ ì œì™¸ */
    padding: 4px 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 0.95em;
    margin-left: 1.7em; /* ì²´í¬ë°•ìŠ¤ ê³µê°„ê³¼ ë™ì¼í•˜ê²Œ */
  }

  .task-actions {
    display: flex;
    align-items: center;
    gap: 5px; /* ë²„íŠ¼ ê°„ê²© */
    flex-shrink: 0; /* ë²„íŠ¼ì´ ì¤„ë°”ê¿ˆë˜ì§€ ì•Šë„ë¡ */
  }

  .edit-task-btn, .delete-task-btn {
    color: #10b981; /* ìˆ˜ì • ë²„íŠ¼ ìƒ‰ìƒ */
    cursor: pointer;
    font-size: 1.2em;
    transition: color 0.2s;
  }
  .edit-task-btn:hover {
    color: #059669;
  }
  .delete-task-btn {
    color: #e63946; /* ì‚­ì œ ë²„íŠ¼ ìƒ‰ìƒ */
  }
  .delete-task-btn:hover {
    color: #d62828;
  }

  /* ê° íƒœìŠ¤í¬ í•­ëª© ë‚´ì— ì¶”ê°€ ë²„íŠ¼ (SVGë¡œ ë³€ê²½ë¨) */
  .add-task-inline-btn {
    position: absolute;
    left: 0; /* LIì˜ ì™¼ìª½ ê°€ì¥ìë¦¬ì— ë°°ì¹˜ */
    top: 50%;
    transform: translateY(-50%);
    background: none !important; /* ë°°ê²½ ì—†ìŒ */
    border: none !important;
    border-radius: 0 !important; /* ì›í˜• ì•„ë‹˜ */
    width: 24px !important; /* SVG í¬ê¸°ì— ë§ì¶¤ */
    height: 24px !important; /* SVG í¬ê¸°ì— ë§ì¶¤ */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 1; /* í•­ìƒ í‘œì‹œ */
    transition: all 0.2s; /* ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
    padding: 0 !important; /* íŒ¨ë”© ì—†ìŒ */
    margin-right: 5px; /* ì²´í¬ë°•ìŠ¤ì™€ ê°„ê²© */
    box-shadow: none !important; /* ê·¸ë¦¼ì ì œê±° */
  }
  .add-task-inline-btn .add-icon {
    width: 100%;
    height: 100%;
  }
  .add-task-inline-btn:hover .add-icon path {
    stroke: url(#addTaskGradientHover); /* í˜¸ë²„ ì‹œ ê·¸ë¼ë°ì´ì…˜ ë³€ê²½ */
  }


  /* Dayì— íƒœìŠ¤í¬ê°€ í•˜ë‚˜ë„ ì—†ì„ ê²½ìš°ì˜ 'ì²« íƒœìŠ¤í¬ ì¶”ê°€' ë²„íŠ¼ */
  .add-first-task-btn {
    background: transparent; /* ë°”íƒ•ìƒ‰ ì—†ìŒ */
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.85em;
    width: 100%; /* ë„ˆë¹„ ê½‰ ì±„ìš°ë„ë¡ */
    text-align: center;
    transition: all 0.2s; /* ë°°ê²½, í…Œë‘ë¦¬, í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€í™”ì— ëŒ€ë¹„ */
    margin-top: 10px; /* Day progress bar ì•„ë˜ ì—¬ë°± */

    /* ê·¸ë¼ë°ì´ì…˜ í…Œë‘ë¦¬ */
    border: 2px solid;
    border-image: linear-gradient(135deg, #34d399, #059669) 1; /* í…Œë‘ë¦¬ì— ê·¸ë¼ë°ì´ì…˜ ì ìš© */
    border-image-slice: 1; /* í…Œë‘ë¦¬ ì´ë¯¸ì§€ê°€ í…Œë‘ë¦¬ë¥¼ ê½‰ ì±„ìš°ë„ë¡ */

    /* í…ìŠ¤íŠ¸/í”ŒëŸ¬ìŠ¤ ì•„ì´ì½˜ ê·¸ë¼ë°ì´ì…˜ ìƒ‰ìƒ */
    color: transparent; /* í…ìŠ¤íŠ¸ ìì²´ëŠ” íˆ¬ëª…í•˜ê²Œ */
    -webkit-background-clip: text; /* í…ìŠ¤íŠ¸ì— ë°°ê²½ í´ë¦½ ì ìš© */
    background-clip: text;
    background-image: linear-gradient(135deg, #34d399 60%, #059669 100%); /* í…ìŠ¤íŠ¸ì— ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
    -webkit-text-fill-color: transparent; /* WebKit ë¸Œë¼ìš°ì €ìš© í…ìŠ¤íŠ¸ ì±„ìš°ê¸° ìƒ‰ìƒ íˆ¬ëª…í•˜ê²Œ */
  }
  .add-first-task-btn:hover {
    /* í˜¸ë²„ ì‹œ ê·¸ë¼ë°ì´ì…˜ ë°˜ì „ ë˜ëŠ” ë‹¤ë¥¸ ìƒ‰ìƒìœ¼ë¡œ */
    border-image: linear-gradient(135deg, #059669, #34d399) 1;
    background-image: linear-gradient(135deg, #059669 60%, #34d399 100%);
  }


  .add-day-btn { /* Category Box ë‚´ Day ì¶”ê°€ ë²„íŠ¼ */
    background: transparent; /* íˆ¬ëª… ë°°ê²½ */
    color: transparent; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ íˆ¬ëª… */
    padding: 8px 12px;
    border: 2px solid #34d399; /* í…Œë‘ë¦¬ ìƒ‰ìƒì„ ê·¸ë¼ë°ì´ì…˜ ì‹œì‘ ìƒ‰ìƒìœ¼ë¡œ ê³ ì • */
    border-radius: 9999px; /* ì™„ì „íˆ ë‘¥ê¸€ê²Œ ì²˜ë¦¬ */
    cursor: pointer;
    margin-top: 15px;
    font-size: 0.85em;
    width: 100%; /* ë„ˆë¹„ë¥¼ ê½‰ ì±„ìš°ë„ë¡ */
    text-align: center;
    transition: all 0.2s; /* ëª¨ë“  ì†ì„± ë³€í™”ì— ëŒ€ë¹„ */
    box-shadow: none; /* ê·¸ë¦¼ì ì œê±° */
    
    /* í…ìŠ¤íŠ¸ ê·¸ë¼ë°ì´ì…˜ */
    -webkit-background-clip: text;
    background-clip: text;
    background-image: linear-gradient(135deg, #34d399 60%, #059669 100%);
    -webkit-text-fill-color: transparent;
  }
  .add-day-btn:hover {
    background: linear-gradient(135deg, #059669, #34d399); /* í˜¸ë²„ ì‹œ ë°°ê²½ ê·¸ë¼ë°ì´ì…˜ */
    border-color: #059669; /* í˜¸ë²„ ì‹œ í…Œë‘ë¦¬ ìƒ‰ìƒ ë³€ê²½ */
    color: white; /* í…ìŠ¤íŠ¸ë¥¼ í°ìƒ‰ìœ¼ë¡œ */
    -webkit-text-fill-color: white; /* ì›¹í‚· ë¸Œë¼ìš°ì €ìš© í…ìŠ¤íŠ¸ í°ìƒ‰ */
    background-clip: border-box; /* ë°°ê²½ í´ë¦½ì„ border-boxë¡œ ì„¤ì •í•˜ì—¬ ì „ì²´ ë²„íŠ¼ì— ì ìš© */
    -webkit-background-clip: border-box;
    box-shadow: none; /* í˜¸ë²„ ì‹œì—ë„ ê·¸ë¦¼ì ì œê±° */
  }


  /* í™”ì‚´í‘œ ë²„íŠ¼ */
  .scroll-button {
    Flex: none !important;
    Align-self: center !important;
    position: fixed;
    top: 50%;
    transform: translateY(-50%); /* ë²„íŠ¼ ìì²´ë¥¼ ì„¸ë¡œ ì¤‘ì•™ìœ¼ë¡œ ì •ë ¬ */
    background-color: transparent;
    color: #10b981;
    border: 2.5px solid #10b981;
    border-radius: 50% !important;
    width: 36px !important;
    height: 36px !important;
    Min-width: 36px !important;
    Min-height: 36px !important;
    Max-width: 36px !important;
    Max-height: 36px !important;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.5em;
    font-weight: bold;
    z-index: 10; /* ê³ ì • í—¤ë”ë³´ë‹¤ ë‚®ì€ z-indexë¡œ ê²¹ì¹˜ì§€ ì•Šë„ë¡ */
    transition: background-color 0.2s, opacity 0.2s;
    opacity: 0.85;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);
    Box-sizing: border-box !important;
    Background-clip: border-box;
    Padding: 0 !important;
    Margin: 0 !important;
  }
  .scroll-button:hover {
    background: linear-gradient(135deg, #34d399 60%, #059669 100%);
    Border-color: #059669;
    opacity: 1;
  }
  .scroll-button:hover.left {
  -webkit-text-fill-color: #fff;
  color: #fff;
  background-clip: border-box;
  -webkit-background-clip: border-box;
  background-image: linear-gradient(135deg, #34d399 60%, #059669 100%);
}
  .scroll-button:hover.right {
  -webkit-text-fill-color: #fff;
  color: #fff;
  background-clip: border-box;
  -webkit-background-clip: border-box;
  background-image: linear-gradient(135deg, #34d399 60%, #059669 100%);
}
  .scroll-button.left {
    Background: transparent;
    Background-clip: border-box;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    Background-image: linear-gradient(135deg, #34d399 60%, #059669 100%);
    Color: #10b981;
    left: 10px; /* í™”ë©´ ì¢Œì¸¡ì—ì„œ 10px ë–¨ì–´ì§ */
  }
  .scroll-button.right {
    Background: transparent;
    Background-clip: border-box;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    Background-image: linear-gradient(135deg, #34d399 60%, #059669 100%);
    Color: #10b981;
    right: 10px; /* í™”ë©´ ìš°ì¸¡ì—ì„œ 10px ë–¨ì–´ì§ */
  }
  .scroll-button.hidden {
    display: none; /* í•„ìš” ì—†ì„ ë•Œ ìˆ¨ê¹€ */
  }


  /* í•˜ë‹¨ ë²„íŠ¼ */
  #buttons {
    text-align: center;
    margin: 20px 0 40px 0;
    display: flex; /* ë²„íŠ¼ì„ ê°€ë¡œë¡œ ì •ë ¬í•˜ê¸° ìœ„í•´ flexbox ì‚¬ìš© */
    justify-content: center; /* ê°€ìš´ë° ì •ë ¬ */
    flex-wrap: wrap; /* ì‘ì€ í™”ë©´ì—ì„œ ì¤„ë°”ê¿ˆ í—ˆìš© */
    gap: 10px; /* ë²„íŠ¼ ê°„ê²© */
  }
  button {
    display: inline-block;
    padding: 10px 20px;
    font-size: 0.9em;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    color: white;
    transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    user-select: none;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }
  #reset-btn { background-color: #e63946; }
  #reset-btn:hover { background-color: #d62828; box-shadow: 0 4px 8px rgba(230,57,70,0.3); }
  #print-pdf-btn { background-color: #1d3557; }
  #print-pdf-btn:hover { background-color: #16315c; box-shadow: 0 4px 8px rgba(29,53,87,0.3); }
  #show-result-btn { background-color: #38a169; }
  #show-result-btn:hover { background-color: #276749; box-shadow: 0 4px 8px rgba(56,161,105,0.3); }
  #print-result-btn { background-color: #ffb703; color: #22223b; }
  #print-result-btn:hover { background-color: #e09f3e; color: #22223b; box-shadow: 0 4px 8px rgba(255,183,3,0.3); }

  /* ì§„ë‹¨ ê²°ê³¼ ì˜ì—­ */
  #diagnosis-result {
    background: white;
    border-radius: 10px;
    padding: 15px 20px;
    box-shadow: 0 1px 5px rgba(0,0,0,0.1);
    max-width: 900px;
    margin: 0 auto 40px auto;
    position: relative;
    border: 1px solid #e0e0e0;
  }
  #diagnosis-result h3 {
    margin-top: 0;
    color: #2d6a4f;
    font-size: 1.3em;
    border-bottom: 1px solid #eee;
    padding-bottom: 10px;
  }
  #diagnosis-result ul {
    max-height: 300px;
    overflow-y: auto;
    padding-left: 20px;
  }
  #diagnosis-result ul li {
    font-size: 0.9em;
    margin-bottom: 8px;
    line-height: 1.4;
  }
  #print-result-btn {
    position: absolute;
    top: 15px;
    right: 20px;
    z-index: 10;
  }

  /* ì»¤ìŠ¤í…€ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
  .custom-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
  }
  .custom-modal-content {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    max-width: 400px;
    width: 90%;
    text-align: center;
    font-family: 'Segoe UI', Arial, sans-serif;
    color: #333;
  }
  .custom-modal-content p {
    margin-bottom: 20px;
    font-size: 1.1em;
  }
  .custom-modal-content input[type="text"] {
    width: calc(100% - 20px);
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 1em;
  }
  .custom-modal-content button {
    padding: 10px 20px;
    margin: 0 8px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.95em;
    transition: background-color 0.2s;
  }
  .custom-modal-content .modal-confirm-btn {
    background-color: #007bff;
    color: white;
  }
  .custom-modal-content .modal-confirm-btn:hover {
    background-color: #0056b3;
  }
  .custom-modal-content .modal-cancel-btn {
    background-color: #6c757d;
    color: white;
  }
  .custom-modal-content .modal-cancel-btn:hover {
    background-color: #5a6268;
  }

  /* ë¯¸ë””ì–´ ì¿¼ë¦¬: ëª¨ë°”ì¼ ìµœì í™” */
  @media (max-width: 768px) {
    body {
      padding: 10px;
      padding-top: 150px; /* ëª¨ë°”ì¼ í—¤ë” ë†’ì´ ê³ ë ¤ */
    }
   #header-title-fixed {
      display: flex !important;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: white;
      z-index: 9999;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      border-bottom: 1px solid #e5e7eb;
    }
    #header-title-fixed h1 {
      display: block !important; 
      color: #2c3e50 !important;
      Margin-left: 10px;
      Font-size: 1.2em; 
      opacity: 1 !important;
    }
    #app-title {
        font-size: 1.2em;
        margin: 0 0 0 10px;
        min-width: unset;
        padding: 0;
    }
      #share-buttons {
    gap: 3px;
    margin-right: 6px;
  }
  .share-btn, .header-action-btn, .download-btn {
    width: 28px;
    height: 28px;
    font-size: 1em;
  }
    #progress-container {
      font-size: 0.9em;
      padding: 8px 15px 8px 15px;
      margin-bottom: 15px; /* ëª¨ë°”ì¼ì—ì„œë„ ê°„ê²© ìœ ì§€ */
    }
    /* ëª¨ë°”ì¼ì—ì„œ ì¹´ë“œ í•˜ë‚˜ì”© ë³´ì´ë„ë¡ */
    #checklist-wrapper {
        padding-left: 10px;
        padding-right: 10px;
    }
    .category-box {
      margin-right: 15px;
      min-width: calc(100% - 30px); /* í™”ë©´ ë„ˆë¹„ì— ë§ì¶° ì¹´ë“œ í•˜ë‚˜ì”© ë³´ì´ë„ë¡ (ì¢Œìš° íŒ¨ë”© ë° ìŠ¤í¬ë¡¤ë°” ì˜ì—­) */
      max-width: none; /* ëª¨ë°”ì¼ì—ì„œëŠ” ìµœëŒ€ ë„ˆë¹„ ì œí•œ í•´ì œ */
    }
    .category-box h2 {
      font-size: 1.4em;
      margin-bottom: 12px;
    }
    .day-section {
      padding: 12px 15px;
      margin-bottom: 10px;
    }
    .day-section h3 {
      font-size: 1em;
      margin-bottom: 6px;
    }
    #diagnosis-result {
      max-width: 100%;
    }
    #print-result-btn {
      position: static; /* ëª¨ë°”ì¼ì—ì„œëŠ” ì •ì ìœ¼ë¡œ ë°°ì¹˜ */
      display: block;
      margin: 10px auto 0 auto;
    }
    /* ì›í˜• ì§„í–‰ë¥  í¬ê¸° ë° ê¸€ì”¨ ì¡°ì ˆ (ëª¨ë°”ì¼) */
    #circular-progress {
      width: 80px;
      height: 80px;
      bottom: 15px;
      right: 15px;
    }
    .circular-svg {
      width: 80px;
      height: 80px;
    }
    .circular-fg {
        transform-origin: 50% 50%; /* ì¤‘ì•™ ê¸°ì¤€ìœ¼ë¡œ íšŒì „ */
        stroke-width: 8;
    }
    .circular-bg {
        stroke-width: 8;
    }
    .circular-text { font-size: 1.3em; }
    .circular-label { font-size: 1.1em; }
    button {
      padding: 8px 15px;
      font-size: 0.85em;
    }
    /* ëª¨ë°”ì¼ì—ì„œ í™”ì‚´í‘œ ë²„íŠ¼ ìœ„ì¹˜ ì¡°ì • */
    .scroll-button {
       .scroll-button {
    width: 28px;
    height: 28px;
    min-width: 28px;
    min-height: 28px;
    max-width: 28px;
    max-height: 28px;
    font-size: 1.1em;
    border-width: 2px;
    }
    #checklist-wrapper .scroll-button.left { left: 5px; }
    #checklist-wrapper .scroll-button.right { right: 5px; }
  }

  /* ì¸ì‡„ ìŠ¤íƒ€ì¼ */
  @media print {
    body {
      background: white;
      color: black;
      padding-top: 0; /* ì¸ì‡„ ì‹œ ìƒë‹¨ íŒ¨ë”© ì œê±° */
    }
    /* ì¸ì‡„ ì‹œ ê³ ì • í—¤ë”, ì§„í–‰ë¥  ë°”, ë²„íŠ¼, ì›í˜• ì§„í–‰ë¥  ìˆ¨ê¹€ */
    #header-title-fixed, #progress-container, #buttons, #circular-progress, h1, .scroll-button {
      display: none !important;
    }
    /* ì¸ì‡„ ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì„¸ë¡œë¡œ ì •ë ¬ */
    #checklist-wrapper {
        margin-top: 0 !important;
        padding: 0 !important;
    }
    #checklist {
      display: block !important;
      overflow-x: visible !important; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ìˆ¨ê¹€ */
      flex-wrap: wrap; /* ë‚´ìš©ì´ ë„˜ì¹˜ë©´ ë‹¤ìŒ ì¤„ë¡œ */
      padding: 0 !important;
      cursor: default; /* ì¸ì‡„ ì‹œ ë“œë˜ê·¸ ì»¤ì„œ ì œê±° */
    }
    .category-box {
      box-shadow: none;
      border-radius: 0;
      border: 1px solid #ccc; /* ì¸ì‡„ ì‹œì—ë„ í…Œë‘ë¦¬ ìœ ì§€ */
      page-break-inside: avoid; /* ë°•ìŠ¤ ì•ˆ ë‚´ìš©ì´ í˜ì´ì§€ë¥¼ ë„˜ì–´ê°€ì§€ ì•Šë„ë¡ */
      margin-right: 0; /* ê°€ë¡œ ê°„ê²© ì œê±° */
      margin-bottom: 10px; /* ì„¸ë¡œ ê°„ê²© ìœ ì§€ */
      min-width: auto !important; /* ìµœì†Œ ë„ˆë¹„ ì œí•œ í•´ì œ */
      max-width: none !important; /* ìµœëŒ€ ë„ˆë¹„ ì œí•œ í•´ì œ */
      width: 100%; /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
    }
    .category-box h2 {
      border-bottom: 1px solid #ccc; /* ì¸ì‡„ ì‹œì—ë„ í…Œë‘ë¦¬ ìœ ì§€ */
      font-size: 1.4em;
    }
    .day-section {
      box-shadow: none;
      border-radius: 0;
      page-break-inside: avoid;
      border: none; /* day-section ë‚´ë¶€ í…Œë‘ë¦¬ ì œê±° */
      padding: 5px 0; /* ë‚´ë¶€ íŒ¨ë”© ì¡°ì ˆ */
    }
    /* ì¸ì‡„ ì‹œ ì²´í¬ë°•ìŠ¤ ë° ë ˆì´ë¸” ìŠ¤íƒ€ì¼ ì¡°ì • */
    input[type="checkbox"] + span::before {
      background-color: #f0f0f0 !important; /* ì¸ì‡„ ì‹œ ë°°ê²½ìƒ‰ ìœ ì§€ */
      border-color: #ccc !important; /* ì¸ì‡„ ì‹œ í…Œë‘ë¦¬ìƒ‰ ìœ ì§€ */
    }
    input[type="checkbox"]:checked + span::before {
      background-color: #34d399 !important; /* ì²´í¬ ì‹œ ë°°ê²½ìƒ‰ */
      border-color: #34d399 !important; /* ì²´í¬ ì‹œ í…Œë‘ë¦¬ìƒ‰ */
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' fill='black' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.207 4.793a1 1 0 011.414 0l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414l3.293 3.293 7.293-7.293a1 1 0 010 1.414z'/%3E%3C/svg%3E"); /* ì²´í¬ ì•„ì´ì½˜ (ê²€ì •ìƒ‰) */
    }
    label:hover {
      transform: none !important;
      background-color: transparent !important;
      padding: 0 !important;
    }
    label {
      cursor: default !important;
    }
    /* ì§„ë‹¨ ê²°ê³¼ë§Œ ì¸ì‡„ ì‹œ ìŠ¤íƒ€ì¼ */
    body.printing-result *:not(#diagnosis-result):not(#diagnosis-result *) {
      display: none !important;
    }
    #diagnosis-result {
      display: block !important;
      position: static !important;
      box-shadow: none !important;
      border-radius: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      max-width: 100% !important;
      border: none !important;
    }
    #diagnosis-result h3 {
      border-bottom: none !important;
      padding-bottom: 0 !important;
      font-size: 1.2em;
    }
    #print-result-btn {
      display: none !important;
    }


#scroll-to-top-btn {
    position: fixed;
    right: 40px;
    bottom: 135px; /* ì›í˜• ì§„í–‰ë¥ (#circular-progress) ìœ„ì— ì ë‹¹íˆ ìœ„ì¹˜ */
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: linear-gradient(135deg, #34d399 60%, #059669 100%);
    color: white;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(16,185,129,0.35);
    cursor: pointer;
    z-index: 2100;
    transition: background 0.2s, box-shadow 0.2s, opacity 0.3s;
    font-size: 2em;
    opacity: 0.93;
  }
  #scroll-to-top-btn:hover {
    background: linear-gradient(135deg, #059669 60%, #34d399 100%);
    box-shadow: 0 8px 18px rgba(16,185,129,0.48);
    opacity: 1;
  }
  #scroll-to-top-btn.hide {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }
  /* ëª¨ë°”ì¼ ìœ„ì¹˜ ì¡°ì • */
  @media (max-width: 768px) {
    #scroll-to-top-btn {
      right: 20px;
      bottom: 100px;
      width: 44px;
      height: 44px;
      font-size: 1.5em;
    }
  }
  }

  /* Day íƒ€ì´í‹€ ì§ì ‘ í¸ì§‘ ìŠ¤íƒ€ì¼ */
  .day-title-editable {
    cursor: text;
    padding: 2px 4px; /* For better click/touch target */
    border-radius: 4px;
    transition: background-color 0.2s;
    min-width: 80px; /* í¸ì§‘ ì‹œ ìµœì†Œ ë„ˆë¹„ */
    display: inline-block; /* spanì´ ë„ˆë¹„ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ */
  }
  .day-title-editable:focus {
    background-color: #e0f2f7;
    outline: 2px solid rgba(16,185,129,0.3);
  }


</style>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>

<div id="header-title-fixed">
  <span id="app-title" contenteditable="true">ğŸ“… ë§ˆì¼€íŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸</span>
  <div id="share-buttons">
    <button class="header-action-btn" id="new-empty-checklist-btn" title="ìƒˆ ë¹ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„±">
      <span class="material-icons">note_add</span>
    </button>
    <button class="header-action-btn" id="btn-save-all" title="í˜„ì¬ ìƒíƒœ ì €ì¥">
      <span class="material-icons">save</span>
    </button>
    <button class="download-btn" id="btn-download" title="ë‹¤ìš´ë¡œë“œ">
      <span class="material-icons">download</span>
    </button>
    <button class="share-btn" id="btn-webshare" title="ê³µìœ ">
      <span class="material-icons">share</span>
    </button>
    <a class="share-btn" id="btn-kakaotalk" title="ì¹´ì¹´ì˜¤í†¡ ê³µìœ " href="#">
      <span class="material-icons">chat</span>
    </a>
  </div>
</div>

<div id="progress-container" aria-label="ì „ì²´ ì§„í–‰ë¥ ">
  <div id="progress-text">ì „ì²´ ì§„í–‰ë¥ : 0%</div>
  <div id="progress-bar-bg" aria-hidden="true">
    <div id="progress-bar-fill"></div>
  </div>
</div>

<div id="circular-progress-wrapper">
<div id="circular-progress">
  <svg class="circular-svg" viewBox="0 0 100 100">
  <defs>
    <linearGradient id="circular-gradient" x1="1" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#6ee7b7"/>
      <stop offset="100%" stop-color="#10b981"/>
    </linearGradient>
  </defs>
  <circle class="circular-bg" cx="50" cy="50" r="40"/>
  <circle class="circular-fg" cx="50" cy="50" r="40" style="stroke-linecap: round;"/>
  <text class="circular-text" x="50" y="42" id="circular-progress-value">0%</text>
  <text class="circular-label" x="50" y="62">ì „ì²´</text>
</svg>
</div>

<button id="scroll-to-top-btn" title="ë§¨ ìœ„ë¡œ ì´ë™" aria-label="ë§¨ ìœ„ë¡œ">
  <span class="material-icons">arrow_upward</span>
</button>
</div>

<h1>ğŸ“… ë§ˆì¼€íŒ… 30ì¼ ì²´í¬ë¦¬ìŠ¤íŠ¸</h1>

<div id="checklist-wrapper">
    <div id="checklist"></div>
    <button class="scroll-button left" id="scroll-left-btn" aria-label="ì´ì „ ì¹´ë“œ ë³´ê¸°">â€¹</button>
    <button class="scroll-button right" id="scroll-right-btn" aria-label="ë‹¤ìŒ ì¹´ë“œ ë³´ê¸°">â€º</button>
</div>


<div id="buttons">
  <button id="reset-btn" title="ëª¨ë“  ì²´í¬ í•­ëª© ì´ˆê¸°í™”">ğŸ”„ ì „ì²´ ì²´í¬ ì´ˆê¸°í™”</button>
  <button id="print-pdf-btn" title="ì¸ì‡„ ë° PDF ì €ì¥">ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥</button>
  <button id="show-result-btn" title="ì§„ë‹¨ ê²°ê³¼ ë³´ê¸°">ğŸ“‹ ì§„ë‹¨ ê²°ê³¼ ë³´ê¸°</button>
</div>

<div id="diagnosis-result" aria-live="polite" style="display:none;">
  <button id="print-result-btn" style="display:none;">ğŸ–¨ï¸ ì§„ë‹¨ ê²°ê³¼ë§Œ ì¸ì‡„/PDF</button>
  <h3>ğŸ“ ì§„ë‹¨ ê²°ê³¼</h3>
  <p id="summary"></p>
  <ul id="completed-tasks-list"></ul>
</div>


<script>

// ë§¨ ìœ„ë¡œ ë²„íŠ¼ ê¸°ëŠ¥
const scrollToTopBtn = document.getElementById('scroll-to-top-btn');

// ë²„íŠ¼ í´ë¦­ ì‹œ ë§¨ ìœ„ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
scrollToTopBtn.addEventListener('click', function() {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
function handleScrollToTopBtn() {
  if (window.scrollY > window.innerHeight * 0.3) {
    scrollToTopBtn.classList.remove('hide');
  } else {
    scrollToTopBtn.classList.add('hide');
  }
}
window.addEventListener('scroll', handleScrollToTopBtn);
handleScrollToTopBtn();

// ê¸°ë³¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„° (ëª¨ë“  íƒœìŠ¤í¬ì— ê³ ìœ  ID ì¶”ê°€)
let checklistData = [
  { day: 1, category: "ì „ëµ ìˆ˜ë¦½ ë° ì‹œì¥ ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“Š ì§€ë‚œë‹¬ KPI ë¦¬ë·°" },
      { id: crypto.randomUUID(), content: "ğŸ“ ì„±ê³¼ ìš”ì•½ ì •ë¦¬" }
  ]},
  { day: 2, category: "ì „ëµ ìˆ˜ë¦½ ë° ì‹œì¥ ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ¯ ì´ë‹¬ KPI ë° ëª©í‘œ ì„¤ì •" },
      { id: crypto.randomUUID(), content: "ğŸ“ˆ í•µì‹¬ ì§€í‘œ ì„ ì •" }
  ]},
  { day: 3, category: "ì „ëµ ìˆ˜ë¦½ ë° ì‹œì¥ ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ” ì‹œì¥ íŠ¸ë Œë“œ ì¡°ì‚¬" },
      { id: crypto.randomUUID(), content: "ğŸŒ íƒ€ê²Ÿ ì‹œì¥ ë°ì´í„° ìˆ˜ì§‘" }
  ]},
  { day: 4, category: "ì „ëµ ìˆ˜ë¦½ ë° ì‹œì¥ ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ‘€ ê²½ìŸì‚¬ ë§ˆì¼€íŒ… ì „ëµ ë¶„ì„" },
      { id: crypto.randomUUID(), content: "ğŸ“¸ ê´‘ê³  ì˜ˆì‹œ ìˆ˜ì§‘" }
  ]},
  { day: 5, category: "ì „ëµ ìˆ˜ë¦½ ë° ì‹œì¥ ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ‘¤ í˜ë¥´ì†Œë‚˜ ì—…ë°ì´íŠ¸" },
      { id: crypto.randomUUID(), content: "ğŸ”¬ ì‚¬ìš©ì ì„¸ë¶„í™”" }
  ]},
  { day: 6, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ¨ ìº í˜ì¸ ì£¼ì œ/ëª©í‘œ ì„¤ì •" },
      { id: crypto.randomUUID(), content: "ğŸ’¡ ìŠ¬ë¡œê±´ ì•„ì´ë””ì–´ ë„ì¶œ" }
  ]},
  { day: 7, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ§  ì½˜í…ì¸  ì•„ì´ë””ì–´ ë¸Œë ˆì¸ìŠ¤í† ë°" },
      { id: crypto.randomUUID(), content: "ğŸ“š ë‚´ìš© ë¶„ë¥˜ (SNS, ì´ë©”ì¼ ë“±)" }
  ]},
  { day: 8, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“… ìº˜ë¦°ë”ì— ì½˜í…ì¸  ë°°ì¹˜" },
      { id: crypto.randomUUID(), content: "ğŸ› ï¸ ì½˜í…ì¸  ì œì‘ ì¼ì • í™•ì •" }
  ]},
  { day: 9, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "âœï¸ ë¸”ë¡œê·¸ ì½˜í…ì¸  ì´ˆì•ˆ ì‘ì„±" },
      { id: crypto.randomUUID(), content: "ğŸ” í‚¤ì›Œë“œ í¬í•¨ ì—¬ë¶€ ì ê²€" }
  ]},
  { day: 10, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ–¼ï¸ SNS ì½˜í…ì¸  ë””ìì¸ ì œì‘" },
      { id: crypto.randomUUID(), content: "ğŸ“ í¬ë§·ë³„ ì´ë¯¸ì§€ ì¤€ë¹„" }
  ]},
  { day: 11, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸª§ ê´‘ê³  ì†Œì¬ ì œì‘" },
      { id: crypto.randomUUID(), content: "ğŸ§ª A/B í…ŒìŠ¤íŠ¸ìš© ë°°ë„ˆ 2ì¢…" }
  ]},
  { day: 12, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“¬ ì´ë©”ì¼ í…œí”Œë¦¿ ë””ìì¸" },
      { id: crypto.randomUUID(), content: "ğŸ¯ CTA ë²„íŠ¼ ë¬¸êµ¬ ê²°ì •" }
  ]},
  { day: 13, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ§± ëœë”© í˜ì´ì§€ êµ¬ì¡° ê¸°íš" },
      { id: crypto.randomUUID(), content: "ğŸ“‹ ì´ˆì•ˆ í”¼ë“œë°± ìˆ˜ë ´" }
  ]},
  { day: 14, category: "ì½˜í…ì¸  ê¸°íš ë° ì œì‘", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ§ ëª¨ë“  ì½˜í…ì¸  ìµœì¢… ê²€í† " },
      { id: crypto.randomUUID(), content: "âœ… ì˜¤ë¥˜ ë° ì˜¤íƒ€ ìˆ˜ì •" }
  ]},
  { day: 15, category: "ìº í˜ì¸ ì‹¤í–‰", tasks: [
      { id: crypto.randomUUID(), content: "ğŸš€ ì½˜í…ì¸  ë°œí–‰ ì‹œì‘" },
      { id: crypto.randomUUID(), content: "ğŸ“¢ SNS ì˜ˆì•½ ê²Œì‹œ ì„¤ì •" }
  ]},
  { day: 16, category: "ìº í˜ì¸ ì‹¤í–‰", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“Š ê´‘ê³  ìº í˜ì¸ ì„¸íŒ…" },
      { id: crypto.randomUUID(), content: "ğŸ› ï¸ íƒ€ê²ŸíŒ… ì„¸ë¶€ ì„¤ì •" }
  ]},
  { day: 17, category: "ìº í˜ì¸ ì‹¤í–‰", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ’° ê´‘ê³  ì˜ˆì‚° ë°°ë¶„" },
      { id: crypto.randomUUID(), content: "ğŸ“… ì¼ì • ì¬í™•ì¸" }
  ]},
  { day: 18, category: "ì„±ê³¼ ì¸¡ì • ë° ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ•µï¸â€â™‚ï¸ ì„±ê³¼ ëª¨ë‹ˆí„°ë§ ë°©ë²• ì„¤ì •" },
      { id: crypto.randomUUID(), content: "ğŸ“ˆ ì‹¤ì‹œê°„ ë°ì´í„° ëŒ€ì‹œë³´ë“œ êµ¬ì¶•" }
  ]},
  { day: 19, category: "ì„±ê³¼ ì¸¡ì • ë° ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“ ì£¼ê°„ ë¦¬í¬íŠ¸ í…œí”Œë¦¿ ì œì‘" },
      { id: crypto.randomUUID(), content: "ğŸ“¤ ìë™ ë°œì†¡ ì‹œìŠ¤í…œ ì ê²€" }
  ]},
  { day: 20, category: "ì„±ê³¼ ì¸¡ì • ë° ë¶„ì„", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ‘¥ ê³ ê° í”¼ë“œë°± ìˆ˜ì§‘ ê³„íš" },
      { id: crypto.randomUUID(), content: "ğŸ“ ì¸í„°ë·° ëŒ€ìƒ ì„ ì •" }
  ]},
  { day: 21, category: "ì½˜í…ì¸  í™•ì¥ ë° ìµœì í™”", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ¥ í”„ë¡œëª¨ì…˜ ì˜ìƒ ê¸°íš" },
      { id: crypto.randomUUID(), content: "ğŸ¬ ì´¬ì˜ ì¼ì • ì¡°ìœ¨" }
  ]},
  { day: 22, category: "ì½˜í…ì¸  í™•ì¥ ë° ìµœì í™”", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“º ì˜ìƒ í¸ì§‘" },
      { id: crypto.randomUUID(), content: "ğŸ¨ ì¸ë„¤ì¼ ì œì‘" }
  ]},
  { day: 2.3, category: "ì½˜í…ì¸  í™•ì¥ ë° ìµœì í™”", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ—£ï¸ ì¸í”Œë£¨ì–¸ì„œ í˜‘ì—… ê²€í† " },
      { id: crypto.randomUUID(), content: "ğŸ¤ ê³„ì•½ ì¡°ê±´ í˜‘ìƒ" }
  ]},
  { day: 24, category: "ê³ ê° ì»¤ë®¤ë‹ˆì¼€ì´ì…˜", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ’¬ SNS ëŒ“ê¸€ ë° ë¬¸ì˜ ëŒ€ì‘" },
      { id: crypto.randomUUID(), content: "ğŸ“ ê³ ê° ìƒë‹´ í”„ë¡œì„¸ìŠ¤ ì ê²€" }
  ]},
  { day: 25, category: "ê°œì„  ë° ë°˜ë³µ", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ’¡ ê°œì„  ì•„ì´ë””ì–´ ë„ì¶œ íšŒì˜" },
      { id: crypto.randomUUID(), content: "ğŸ“ ì‹¤í–‰ ê³„íš ìˆ˜ë¦½" }
  ]},
  { day: 26, category: "ê°œì„  ë° ë°˜ë³µ", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“¢ ë¦¬íƒ€ê²ŸíŒ… ìº í˜ì¸ ì‹œì‘" },
      { id: crypto.randomUUID(), content: "ğŸ”„ ê´‘ê³  ì†Œì¬ êµì²´" }
  ]},
  { day: 27, category: "ê°œì„  ë° ë°˜ë³µ", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ“Š ìº í˜ì¸ ì„±ê³¼ ë¶„ì„" },
      { id: crypto.randomUUID(), content: "ğŸ“ˆ ë³´ê³ ì„œ ì‘ì„±" }
  ]},
  { day: 28, category: "ë°ì´í„° ê´€ë¦¬ ë° ì •ë¦¬", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ§¹ ë°ì´í„° ì •ë¦¬ ë° ë°±ì—…" },
      { id: crypto.randomUUID(), content: "ğŸ“‚ íŒŒì¼ ì•„ì¹´ì´ë¸Œ ì™„ë£Œ" }
  ]},
  { day: 29, category: "ì„±ê³¼ ê³µìœ  ë° ë‹¤ìŒ ìŠ¤í…", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ‰ ì„±ê³µ ì‚¬ë¡€ ê³µìœ " },
      { id: crypto.randomUUID(), content: "ğŸ‘ íŒ€ì› í”¼ë“œë°± ìˆ˜ì§‘" }
  ]},
  { day: 30, category: "ì„±ê³¼ ê³µìœ  ë° ë‹¤ìŒ ìŠ¤í…", tasks: [
      { id: crypto.randomUUID(), content: "ğŸ”” ë‹¤ìŒ ë‹¬ ì¤€ë¹„ ì‹œì‘" },
      { id: crypto.randomUUID(), content: "ğŸ“… ì¼ì • ê³„íš ìˆ˜ë¦½" }
  ]}
];


// DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
const checklist = document.getElementById("checklist");
const checklistWrapper = document.getElementById("checklist-wrapper");
const progressText = document.getElementById("progress-text");
const progressBarFill = document.getElementById("progress-bar-fill");
const resetBtn = document.getElementById("reset-btn");
const printPdfBtn = document.getElementById("print-pdf-btn");
const diagnosisResult = document.getElementById("diagnosis-result");
const summaryText = document.getElementById("summary");
const completedTasksList = document.getElementById("completed-tasks-list");
const showResultBtn = document.getElementById("show-result-btn");
const printResultBtn = document.getElementById("print-result-btn");
const circularProgressValue = document.getElementById("circular-progress-value");
const circularFg = document.querySelector(".circular-fg");
const scrollLeftBtn = document.getElementById("scroll-left-btn");
const scrollRightBtn = document.getElementById("scroll-right-btn");
// í—¤ë”ì— ìˆëŠ” ìƒˆ ë¹ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„± ë²„íŠ¼
const newEmptyChecklistBtn = document.getElementById("new-empty-checklist-btn");
// í—¤ë”ì— ìˆëŠ” ì €ì¥ ë²„íŠ¼
const saveAllBtn = document.getElementById("btn-save-all");
// ì•± íƒ€ì´í‹€
const appTitleElement = document.getElementById("app-title");


// ì›í˜• ì§„í–‰ë¥  ê³„ì‚°ì„ ìœ„í•œ ìƒìˆ˜
const CIRCUMFERENCE = 2 * Math.PI * 40; // SVG ì›ì˜ ë°˜ì§€ë¦„ (r=40px)ì— ë”°ë¼ ë‘˜ë ˆ ê³„ì‚°

// ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í‚¤
const STORAGE_KEY_DATA = "marketingChecklistData"; // ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„° ìì²´ ì €ì¥
const STORAGE_KEY_CHECKS = "marketingChecklistChecks"; // ì²´í¬ ìƒíƒœë§Œ ì €ì¥
const STORAGE_KEY_APP_TITLE = "marketingChecklistAppTitle"; // ì•± ì œëª© ì €ì¥

// ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì €ì¥ëœ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸° ë˜ëŠ” ì´ˆê¸°í™”
let checklistState = {};

// ë“œë˜ê·¸ ê´€ë ¨ ë³€ìˆ˜ë“¤ ì„ ì–¸ì„ ìµœìƒë‹¨ìœ¼ë¡œ ì´ë™
let isDragging = false;
let startX;
let scrollLeft;

// ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒíƒœë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
function saveState() {
  localStorage.setItem(STORAGE_KEY_DATA, JSON.stringify(checklistData)); // checklistData ì „ì²´ ì €ì¥
  localStorage.setItem(STORAGE_KEY_CHECKS, JSON.stringify(checklistState)); // ì²´í¬ ìƒíƒœ ë³„ë„ë¡œ ì €ì¥
  localStorage.setItem(STORAGE_KEY_APP_TITLE, appTitleElement.textContent.trim()); // ì•± ì œëª© ì €ì¥
  console.log("ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„° ë° ìƒíƒœê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
}

/**
 * ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì €ì¥ëœ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ì™€ ìƒíƒœë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
 * ê¸°ì¡´ ë°ì´í„°ì— IDê°€ ì—†ëŠ” ê²½ìš° ìƒˆë¡œ ìƒì„±í•˜ê³ , ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° ê¸°ë³¸ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤.
 */
function loadState() {
    const savedData = localStorage.getItem(STORAGE_KEY_DATA);
    const savedChecks = localStorage.getItem(STORAGE_KEY_CHECKS);
    const savedAppTitle = localStorage.getItem(STORAGE_KEY_APP_TITLE);

    if (savedData) {
        checklistData = JSON.parse(savedData);
        // ì €ì¥ëœ ë°ì´í„°ì˜ ëª¨ë“  íƒœìŠ¤í¬ê°€ IDë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸ (ì´ì „ ë²„ì „ í˜¸í™˜ì„±)
        checklistData.forEach(dayObj => {
            dayObj.tasks = dayObj.tasks.map(task => {
                // ì´ì „ ë²„ì „ì—ì„œ ë¬¸ìì—´ë¡œ ì €ì¥ëœ ê²½ìš° ë˜ëŠ” IDê°€ ì—†ëŠ” ê²½ìš°
                if (typeof task === 'string' || !task.id) {
                    return { id: crypto.randomUUID(), content: typeof task === 'string' ? task : task.content };
                }
                return task;
            });
            // displayTitle ì†ì„±ì´ ì—†ëŠ” ê²½ìš° ì¶”ê°€ (ì´ì „ ë²„ì „ í˜¸í™˜ì„±)
            if (!dayObj.displayTitle) {
                dayObj.displayTitle = `ğŸ“… Day ${dayObj.day}`;
            }
        });
    } else {
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°, ì´ˆê¸° checklistDataë¥¼ ì‚¬ìš©
        // ì´ˆê¸° checklistDataëŠ” ì´ë¯¸ IDë¥¼ ê°€ì§€ê³  ìˆë„ë¡ ì •ì˜ë¨
        // displayTitle ì¶”ê°€
        checklistData.forEach(dayObj => {
            if (!dayObj.displayTitle) {
                dayObj.displayTitle = `ğŸ“… Day ${dayObj.day}`;
            }
        });
    }

    if (savedChecks) {
        checklistState = JSON.parse(savedChecks);
    } else {
        checklistState = {};
    }

    if (savedAppTitle) {
        appTitleElement.textContent = savedAppTitle;
    }
}


/**
 * ì»¤ìŠ¤í…€ ì•Œë¦¼/í™•ì¸ ëª¨ë‹¬ì„ ìƒì„±í•˜ê³  í‘œì‹œí•©ë‹ˆë‹¤.
 * @param {string} message - ëª¨ë‹¬ì— í‘œì‹œí•  ë©”ì‹œì§€.
 * @param {string} type - 'alert', 'confirm', 'prompt' ì¤‘ í•˜ë‚˜.
 * @param {string} [defaultValue=''] - prompt íƒ€ì…ì¼ ê²½ìš° ê¸°ë³¸ ê°’.
 * @returns {Promise<string|boolean|null>} - confirmì€ true/false, promptëŠ” ì…ë ¥ê°’, alertëŠ” null ë°˜í™˜.
 */
function showCustomModal(message, type, defaultValue = '') {
  return new Promise((resolve) => {
    const overlay = document.createElement('div');
    overlay.className = 'custom-modal-overlay';

    const content = document.createElement('div');
    content.className = 'custom-modal-content';

    const messagePara = document.createElement('p');
    messagePara.textContent = message;
    content.appendChild(messagePara);

    let inputField;
    if (type === 'prompt') {
      inputField = document.createElement('input');
      inputField.type = 'text';
      inputField.value = defaultValue;
      content.appendChild(inputField);
    }

    const buttonContainer = document.createElement('div');

    if (type === 'alert') {
      const okButton = document.createElement('button');
      okButton.textContent = 'í™•ì¸';
      okButton.className = 'modal-confirm-btn';
      okButton.onclick = () => {
        document.body.removeChild(overlay);
        resolve(null);
      };
      buttonContainer.appendChild(okButton);
    } else if (type === 'confirm') {
      const yesButton = document.createElement('button');
      yesButton.textContent = 'ì˜ˆ';
      yesButton.className = 'modal-confirm-btn';
      yesButton.onclick = () => {
        document.body.removeChild(overlay);
        resolve(true);
      };
      buttonContainer.appendChild(yesButton);

      const noButton = document.createElement('button');
      noButton.textContent = 'ì•„ë‹ˆì˜¤';
      noButton.className = 'modal-cancel-btn';
      noButton.onclick = () => {
        document.body.removeChild(overlay);
        resolve(false);
      };
      buttonContainer.appendChild(noButton);
    } else if (type === 'prompt') {
      const okButton = document.createElement('button');
      okButton.textContent = 'í™•ì¸';
      okButton.className = 'modal-confirm-btn';
      okButton.onclick = () => {
        document.body.removeChild(overlay);
        resolve(inputField.value);
      };
      buttonContainer.appendChild(okButton);

      const cancelButton = document.createElement('button');
      cancelButton.textContent = 'ì·¨ì†Œ';
      cancelButton.className = 'modal-cancel-btn';
      cancelButton.onclick = () => {
        document.body.removeChild(overlay);
        resolve(null); // ì·¨ì†Œ ì‹œ null ë°˜í™˜
      };
      buttonContainer.appendChild(cancelButton);
      // promptì¼ ê²½ìš° input í•„ë“œì—ì„œ Enter í‚¤ ì…ë ¥ ì‹œ í™•ì¸ ë²„íŠ¼ í´ë¦­ íš¨ê³¼
      inputField.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          okButton.click();
        }
      });
    }

    content.appendChild(buttonContainer);
    overlay.appendChild(content);
    document.body.appendChild(overlay);

    // promptì¼ ê²½ìš° input í•„ë“œì— ìë™ìœ¼ë¡œ í¬ì»¤ìŠ¤
    if (inputField) {
      inputField.focus();
    }
  });
}


// ì›í˜• ì§„í–‰ë¥ ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
function updateCircularProgress(percent) {
  if (circularProgressValue) {
    circularProgressValue.textContent = percent + "%";
  }
  if (circularFg) {
    const offset = CIRCUMFERENCE * (1 - percent / 100);
    // ë°˜ë“œì‹œ ë‘˜ë ˆ ë‘ ë²ˆ ë°˜ë³µ!
    circularFg.style.strokeDasharray = `${CIRCUMFERENCE} ${CIRCUMFERENCE}`;
    circularFg.style.strokeDashoffset = offset;
  }
}

// ì „ì²´ ì§„í–‰ë¥ ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
function updateOverallProgress() {
  const totalTasks = checklistData.reduce((acc, day) => acc + day.tasks.length, 0);
  const doneTasks = Object.values(checklistState).filter(v => v).length;
  const percent = totalTasks ? Math.round((doneTasks / totalTasks) * 100) : 0;
  progressText.textContent = `ì „ì²´ ì§„í–‰ë¥ : ${percent}%`;
  progressBarFill.style.width = percent + "%";
  updateCircularProgress(percent); // ì›í˜• ì§„í–‰ë¥ ë„ ì—…ë°ì´íŠ¸
}

// ê° Day ì„¹ì…˜ì˜ ì§„í–‰ë¥ ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
function updateDayProgress(day) {
  day = Number(day);
  const daySection = document.getElementById(`day-${day}`);
  const dayObj = checklistData.find(d => Number(d.day) === day);
  if (!daySection || !dayObj) return; // ìš”ì†Œë‚˜ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì¢…ë£Œ

  const tasks = dayObj.tasks;
  let doneCount = 0;
  for (const task of tasks) { // ID ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½
    if (checklistState[task.id]) doneCount++; // ì™„ë£Œëœ íƒœìŠ¤í¬ ì¹´ìš´íŠ¸
  }
  const percent = tasks.length ? Math.round((doneCount / tasks.length) * 100) : 0;

  // í¼ì„¼íŠ¸ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
  const progressTextElement = daySection.querySelector(".day-progress-text");
  if (progressTextElement) progressTextElement.textContent = `${percent}% ì™„ë£Œ`;
  // í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸
  const progressBarFillElement = daySection.querySelector(".day-progress-bar-fill");
  if (progressBarFillElement) progressBarFillElement.style.width = percent + "%";
}

// ì¹´í…Œê³ ë¦¬ ì™„ë£Œ ì—¬ë¶€ í™•ì¸ ë° ë‹¤ìŒ ì¹´í…Œê³ ë¦¬ë¡œ ìŠ¤í¬ë¡¤í•˜ëŠ” í•¨ìˆ˜
function checkCategoryCompletionAndScroll(updatedDay) {
    const dayItem = checklistData.find(d => d.day === updatedDay);
    if (!dayItem) return;

    const categoryName = dayItem.category;
    const daysInThisCategory = checklistData.filter(d => d.category === categoryName);

    let allTasksInCategoriesCompleted = true;
    for (const dayObj of daysInThisCategory) {
        for (const task of dayObj.tasks) { // ID ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½
            if (!checklistState[task.id]) {
                allTasksInCategoriesCompleted = false;
                break;
            }
        }
        if (!allTasksInCategoriesCompleted) break;
    }

    if (allTasksInCategoriesCompleted) {
        const currentCategoryBoxId = `category-header-${categoryName.replace(/\s/g, '-')}`;
        const currentCategoryBox = document.getElementById(currentCategoryBoxId);
        // ë¶€ëª¨ ìš”ì†Œë¥¼ ì°¾ì•„ì„œ ë‹¤ìŒ í˜•ì œ ìš”ì†Œë¡œ ì´ë™
        if (currentCategoryBox) {
            const parentCategoryBox = currentCategoryBox.closest('.category-box');
            const nextCategoryBox = parentCategoryBox ? parentCategoryBox.nextElementSibling : null;

            if (nextCategoryBox && nextCategoryBox.classList.contains('category-box')) {
                checklist.scrollTo({
                    left: nextCategoryBox.offsetLeft - checklist.offsetLeft, // ë‹¤ìŒ ì¹´ë“œì˜ ì‹œì‘ ìœ„ì¹˜ë¡œ ìŠ¤í¬ë¡¤
                    behavior: 'smooth'
                });
            }
        }
    }
}

// í™”ì‚´í‘œ ë²„íŠ¼ ê°€ì‹œì„± ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updateArrowButtonVisibility() {
    const maxScrollLeft = checklist.scrollWidth - checklist.clientWidth;

    if (checklist.scrollLeft <= 5) { // ê±°ì˜ ë§¨ ì™¼ìª½ì¼ ë•Œ
        scrollLeftBtn.classList.add('hidden');
    } else {
        scrollLeftBtn.classList.remove('hidden');
    }

    if (checklist.scrollLeft >= maxScrollLeft - 5) { // ê±°ì˜ ë§¨ ì˜¤ë¥¸ìª½ì¼ ë•Œ
        scrollRightBtn.classList.add('hidden');
    } else {
        scrollRightBtn.classList.remove('hidden');
    }
}

// í™”ì‚´í‘œ ë²„íŠ¼ ìˆ˜ì§ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ìŠ¤í¬ë¡¤ì— ë”°ë¼ ì›€ì§ì´ë„ë¡)
function updateArrowVerticalPosition() {
    const checklistRect = checklist.getBoundingClientRect(); // checklist ìš”ì†Œì˜ ìœ„ì¹˜ì™€ í¬ê¸°
    const arrowHeight = scrollLeftBtn.offsetHeight; // í™”ì‚´í‘œ ë²„íŠ¼ì˜ ë†’ì´

    // checklist ì»¨í…Œì´ë„ˆì˜ ë³´ì´ëŠ” ë¶€ë¶„ì˜ ì„¸ë¡œ ì¤‘ì•™ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
    // viewport ê¸°ì¤€ checklist ì»¨í…Œì´ë„ˆì˜ ìƒë‹¨ + (checklist ì»¨í…Œì´ë„ˆì˜ ë†’ì´ / 2) - (í™”ì‚´í‘œ ë†’ì´ / 2)
    let targetTop = checklistRect.top + (checklistRect.height / 2) - (arrowHeight / 2);

    // ê³ ì • í—¤ë”ì˜ ë†’ì´ë¥¼ ê³ ë ¤í•˜ì—¬ í™”ì‚´í‘œê°€ í—¤ë”ì— ê°€ë ¤ì§€ì§€ ì•Šë„ë¡ ì¡°ì •
    const headerHeight = document.getElementById('header-title-fixed').offsetHeight;
    if (targetTop < headerHeight + 10) { // í—¤ë” ì•„ë˜ 10px ì—¬ë°±
        targetTop = headerHeight + 10;
    }

    // í™”ë©´ í•˜ë‹¨ì— ë„ˆë¬´ ê°€ê¹ê²Œ ë¶™ì§€ ì•Šë„ë¡ ì¡°ì •
    if (targetTop > window.innerHeight - arrowHeight - 20) { // í•˜ë‹¨ 20px ì—¬ë°±
        targetTop = window.innerHeight - arrowHeight - 20;
    }

    // ê³„ì‚°ëœ top ìœ„ì¹˜ë¥¼ í™”ì‚´í‘œ ë²„íŠ¼ì— ì ìš©
    scrollLeftBtn.style.top = `${targetTop}px`;
    scrollRightBtn.style.top = `${targetTop}px`;
}


// í™”ì‚´í‘œ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
scrollLeftBtn.addEventListener('click', () => {
    const currentScrollLeft = checklist.scrollLeft;
    let targetScrollLeft = currentScrollLeft;
    const categoryBoxes = checklist.querySelectorAll('.category-box');

    // í˜„ì¬ ë³´ì´ëŠ” ì¹´ë“œë³´ë‹¤ ì™¼ìª½ìœ¼ë¡œ ì´ë™í•  ì¹´ë“œ ì°¾ê¸°
    for (let i = categoryBoxes.length - 1; i >= 0; i--) {
        const box = categoryBoxes[i];
        if (box.offsetLeft < currentScrollLeft - 10) { // í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë³´ë‹¤ ì™¼ìª½ì— ìˆëŠ” ì¹´ë“œ
            targetScrollLeft = box.offsetLeft - 20; // 20px ì—¬ë°± ì¶”ê°€
            break;
        }
        if (i === 0) { // ì²«ë²ˆì§¸ ì¹´ë“œì¸ ê²½ìš° ë§¨ ì™¼ìª½ìœ¼ë¡œ
            targetScrollLeft = 0;
        }
    }
    checklist.scrollTo({
        left: targetScrollLeft,
        behavior: 'smooth'
    });
});

scrollRightBtn.addEventListener('click', () => {
    const currentScrollLeft = checklist.scrollLeft;
    let targetScrollLeft = currentScrollLeft;
    const categoryBoxes = checklist.querySelectorAll('.category-box');

    // í˜„ì¬ ë³´ì´ëŠ” ì˜ì—­ì˜ ì˜¤ë¥¸ìª½ ê²½ê³„ë³´ë‹¤ ë‹¤ìŒ ë°•ìŠ¤ê°€ ì‹œì‘ë  ë•Œ
    for (let i = 0; i < categoryBoxes.length; i++) {
        const box = categoryBoxes[i];
        if (box.offsetLeft > currentScrollLeft + checklist.clientWidth - 10) {
            targetScrollLeft = box.offsetLeft;
            // ëª¨ë°”ì¼ ë·°í¬íŠ¸ì—ì„œ í•œ ì¹¸ì”© ì´ë™í•˜ë„ë¡ ì¡°ì •
            if (window.innerWidth <= 768) {
                targetScrollLeft -= 10; // ëª¨ë°”ì¼ ì¢Œì¸¡ íŒ¨ë”©
            }
            break;
        }
        if (i === categoryBoxes.length - 1) { // ë§ˆì§€ë§‰ ì¹´ë“œì¸ ê²½ìš° ë§¨ ì˜¤ë¥¸ìª½ìœ¼ë¡œ
            targetScrollLeft = checklist.scrollWidth - checklist.clientWidth;
        }
    }
    checklist.scrollTo({
        left: targetScrollLeft,
        behavior: 'smooth'
    });
});

// ë“œë˜ê·¸ ê¸°ëŠ¥ êµ¬í˜„
checklist.addEventListener('mousedown', (e) => {
  isDragging = true;
  checklist.classList.add('grabbing');
  startX = e.pageX - checklist.offsetLeft;
  scrollLeft = checklist.scrollLeft;
  // ë“œë˜ê·¸ ì¤‘ í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€
  e.preventDefault();
});

checklist.addEventListener('mouseleave', () => {
  isDragging = false;
  checklist.classList.remove('grabbing');
});

checklist.addEventListener('mouseup', () => {
  isDragging = false;
  checklist.classList.remove('grabbing');
});

checklist.addEventListener('mousemove', (e) => {
  if (!isDragging) return;
  e.preventDefault(); // ê¸°ë³¸ ë“œë˜ê·¸ ë™ì‘(ìŠ¤í¬ë¡¤) ë°©ì§€
  const x = e.pageX - checklist.offsetLeft;
  const walk = (x - startX); // ì´ë™ ê±°ë¦¬
  checklist.scrollLeft = scrollLeft - walk; // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
});

// í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼ ë“œë˜ê·¸/ìŠ¤ì™€ì´í”„)
checklist.addEventListener('touchstart', (e) => {
    isDragging = true;
    checklist.classList.add('grabbing');
    startX = e.touches[0].pageX - checklist.offsetLeft;
    scrollLeft = checklist.scrollLeft;
});

checklist.addEventListener('touchend', () => {
    isDragging = false;
    checklist.classList.remove('grabbing');
});

checklist.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    const x = e.touches[0].pageX - checklist.offsetLeft;
    const walk = (x - startX);
    checklist.scrollLeft = scrollLeft - walk;
});


// ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (í™”ì‚´í‘œ ê°€ì‹œì„± ì—…ë°ì´íŠ¸)
checklist.addEventListener('scroll', updateArrowButtonVisibility);


/**
 * ìƒˆ íƒœìŠ¤í¬ë¥¼ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
 * @param {string} categoryName - íƒœìŠ¤í¬ê°€ ì†í•  ì¹´í…Œê³ ë¦¬ ì´ë¦„
 * @param {number} dayNumber - íƒœìŠ¤í¬ê°€ ì†í•  Day ë²ˆí˜¸
 * @param {string} taskContent - ì¶”ê°€í•  íƒœìŠ¤í¬ ë‚´ìš©
 * @param {string|null} [insertAfterTaskId=null] - ì´ íƒœìŠ¤í¬ ID ë‹¤ìŒì— ìƒˆ íƒœìŠ¤í¬ë¥¼ ì‚½ì…í•©ë‹ˆë‹¤. nullì´ë©´ ë§ˆì§€ë§‰ì— ì¶”ê°€.
 */
function addTaskToDay(categoryName, dayNumber, taskContent, insertAfterTaskId = null) {
    const dayObj = checklistData.find(d => d.category === categoryName && d.day === dayNumber);
    if (dayObj) {
        const newTask = { id: crypto.randomUUID(), content: taskContent };
        if (insertAfterTaskId) {
            const index = dayObj.tasks.findIndex(t => t.id === insertAfterTaskId);
            if (index !== -1) {
                dayObj.tasks.splice(index + 1, 0, newTask); // íŠ¹ì • íƒœìŠ¤í¬ ë’¤ì— ì‚½ì…
            } else {
                dayObj.tasks.push(newTask); // IDë¥¼ ì°¾ì§€ ëª»í•˜ë©´ ê·¸ëƒ¥ ë§ˆì§€ë§‰ì— ì¶”ê°€
            }
        } else {
            dayObj.tasks.push(newTask); // ë§ˆì§€ë§‰ì— ì¶”ê°€
        }
        checklistState[newTask.id] = false; // ìƒˆ íƒœìŠ¤í¬ì˜ ìƒíƒœëŠ” ê¸°ë³¸ì ìœ¼ë¡œ false (ë¯¸ì™„ë£Œ)
        saveState();
        buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
        updateOverallProgress();
    }
}

/**
 * ìƒˆ Day ì„¹ì…˜ì„ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
 * @param {string} categoryName - Dayê°€ ì†í•  ì¹´í…Œê³ ë¦¬ ì´ë¦„
 * @param {Array<Object>} [tasks=[]] - ìƒˆë¡œìš´ Dayì— í¬í•¨ë  íƒœìŠ¤í¬ ë°°ì—´ (ì„ íƒ ì‚¬í•­, {id, content} í˜•ì‹)
 */
function addDayToCategory(categoryName, tasks = []) {
    // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ë§ˆì§€ë§‰ Day ë²ˆí˜¸ ì°¾ê¸°
    const daysInThisCategory = checklistData.filter(d => d.category === categoryName);
    let maxDayInCat = daysInThisCategory.length > 0 ? Math.max(...daysInThisCategory.map(item => item.day)) : 0;
    
    // ì „ì²´ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ì˜ ìµœëŒ€ Day ë²ˆí˜¸ ì°¾ê¸° (ê²¹ì¹˜ì§€ ì•Šë„ë¡)
    let currentMaxOverallDay = checklistData.length > 0 ? Math.max(...checklistData.map(item => item.day)) : 0;
    
    // ìƒˆë¡œìš´ Day ë²ˆí˜¸ëŠ” í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ë‹¤ìŒ ë²ˆí˜¸ ë˜ëŠ” ì „ì²´ì˜ ë‹¤ìŒ ë²ˆí˜¸ ì¤‘ í° ê°’
    // ì´ë ‡ê²Œ í•˜ë©´ Day ë²ˆí˜¸ê°€ ìœ ë‹ˆí¬í•˜ê²Œ ìœ ì§€ë˜ë©´ì„œë„ ê°€ëŠ¥í•œ í•œ ì—°ì†ì ìœ¼ë¡œ ë¶€ì—¬ë©ë‹ˆë‹¤.
    const newDayNumber = Math.max(maxDayInCat + 1, currentMaxOverallDay + 1);

    const newDayObj = { day: newDayNumber, category: categoryName, tasks: tasks, displayTitle: `ğŸ“… Day ${newDayNumber}` }; // Add displayTitle
    checklistData.push(newDayObj);
    checklistData.sort((a, b) => a.day - b.day); // Day ìˆœì„œëŒ€ë¡œ ì •ë ¬
    saveState();
    buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
    updateOverallProgress();
}

/**
 * íƒœìŠ¤í¬ í•­ëª©ì„ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜
 * @param {string} taskIdToDelete - ì‚­ì œí•  íƒœìŠ¤í¬ì˜ ê³ ìœ  ID
 * @param {number} dayNumber - í•´ë‹¹ íƒœìŠ¤í¬ì˜ Day ë²ˆí˜¸
 */
async function deleteTask(taskIdToDelete, dayNumber) {
    const confirmed = await showCustomModal("ì´ íƒœìŠ¤í¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?", 'confirm');
    if (confirmed) {
        const dayObj = checklistData.find(d => d.day === dayNumber);
        if (dayObj) {
            dayObj.tasks = dayObj.tasks.filter(task => task.id !== taskIdToDelete); // IDë¡œ íƒœìŠ¤í¬ ì œê±°
            delete checklistState[taskIdToDelete]; // ì²´í¬ ìƒíƒœ ì‚­ì œ
            saveState();
            buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
            updateOverallProgress();
        }
    }
}

/**
 * Day ì„¹ì…˜ ì „ì²´ë¥¼ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜
 * @param {number} dayToDelete - ì‚­ì œí•  Day ë²ˆí˜¸
 */
async function deleteDay(dayToDelete) {
    const confirmed = await showCustomModal(`Day ${dayToDelete} ì„¹ì…˜ ì „ì²´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`, 'confirm');
    if (confirmed) {
        const dayObj = checklistData.find(d => d.day === dayToDelete);
        if (dayObj) {
            dayObj.tasks.forEach(task => { // í•´ë‹¹ Dayì˜ ëª¨ë“  íƒœìŠ¤í¬ ì²´í¬ ìƒíƒœ ì‚­ì œ
                delete checklistState[task.id];
            });
        }
        checklistData = checklistData.filter(d => d.day !== dayToDelete);
        saveState();
        buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
        updateOverallProgress();
    }
}

/**
 * ì¹´í…Œê³ ë¦¬ ì „ì²´ë¥¼ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜
 * @param {string} categoryToDelete - ì‚­ì œí•  ì¹´í…Œê³ ë¦¬ ì´ë¦„
 */
async function deleteCategory(categoryToDelete) {
    const confirmed = await showCustomModal(`'${categoryToDelete}' ì¹´í…Œê³ ë¦¬ ì „ì²´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì´ ì¹´í…Œê³ ë¦¬ì˜ ëª¨ë“  Dayì™€ íƒœìŠ¤í¬ê°€ ì‚­ì œë©ë‹ˆë‹¤)`, 'confirm');
    if (confirmed) {
        const daysInCat = checklistData.filter(d => d.category === categoryToDelete);
        daysInCat.forEach(dayObj => {
            dayObj.tasks.forEach(task => { // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ëª¨ë“  Dayì™€ íƒœìŠ¤í¬ ì²´í¬ ìƒíƒœ ì‚­ì œ
                delete checklistState[task.id];
            });
        });
        checklistData = checklistData.filter(d => d.category !== categoryToDelete);
        saveState();
        buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
        updateOverallProgress();
    }
}

/**
 * íƒœìŠ¤í¬ í•­ëª©ì„ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
 * @param {string} taskIdToEdit - ìˆ˜ì •í•  íƒœìŠ¤í¬ì˜ ê³ ìœ  ID
 * @param {number} dayNumber - í•´ë‹¹ íƒœìŠ¤í¬ì˜ Day ë²ˆí˜¸
 * @param {string} currentText - í˜„ì¬ íƒœìŠ¤í¬ ë‚´ìš©
 */
async function editTask(taskIdToEdit, dayNumber, currentText) {
    const newText = await showCustomModal("íƒœìŠ¤í¬ ë‚´ìš©ì„ ìˆ˜ì •í•˜ì„¸ìš”:", 'prompt', currentText);
    if (newText !== null && newText.trim() !== '') { // ì·¨ì†Œí•˜ì§€ ì•Šê³  ë¹ˆ ë¬¸ìì—´ë„ ì•„ë‹ˆë©´
        const dayObj = checklistData.find(d => d.day === dayNumber);
        if (dayObj) {
            const taskToUpdate = dayObj.tasks.find(task => task.id === taskIdToEdit);
            if (taskToUpdate) {
                taskToUpdate.content = newText.trim();
                saveState(); // ìƒíƒœ ì €ì¥
                buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
                updateOverallProgress();
            }
        }
    }
}

/**
 * ì¹´í…Œê³ ë¦¬ ì´ë¦„ì„ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
 * @param {string} oldCategoryName - ê¸°ì¡´ ì¹´í…Œê³ ë¦¬ ì´ë¦„
 */
async function editCategory(oldCategoryName) {
    const newCategoryName = await showCustomModal("ì¹´í…Œê³ ë¦¬ ì´ë¦„ì„ ìˆ˜ì •í•˜ì„¸ìš”:", 'prompt', oldCategoryName);
    if (newCategoryName !== null && newCategoryName.trim() !== '' && newCategoryName.trim() !== oldCategoryName) {
        checklistData.forEach(item => {
            if (item.category === oldCategoryName) {
                item.category = newCategoryName.trim();
            }
        });
        saveState();
        buildChecklist();
        updateOverallProgress();
    }
}


// ì²´í¬ë¦¬ìŠ¤íŠ¸ UIë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
function buildChecklist() {
  checklist.innerHTML = ""; // ê¸°ì¡´ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”

  // ë°ì´í„°ë¥¼ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”
  const categories = {};
  checklistData.forEach(item => {
    if (!categories[item.category]) {
      categories[item.category] = [];
    }
    categories[item.category].push(item);
  });

  // ê·¸ë£¹í™”ëœ ì¹´í…Œê³ ë¦¬ë³„ë¡œ UI ìƒì„±
  for (const categoryName in categories) {
    const categoryBox = document.createElement("div");
    categoryBox.className = "category-box";
    categoryBox.setAttribute("aria-labelledby", `category-header-${categoryName.replace(/\s/g, '-')}`);

    const categoryHeader = document.createElement("h2");
    const categoryTitleSpan = document.createElement('span');
    categoryTitleSpan.id = `category-header-${categoryName.replace(/\s/g, '-')}`;
    
    // ì¹´í…Œê³ ë¦¬ë³„ Material Icons ì„¤ì •
    let icon = '';
    switch (categoryName) {
      case 'ì „ëµ ìˆ˜ë¦½ ë° ì‹œì¥ ë¶„ì„': icon = 'insights'; break;
      case 'ì½˜í…ì¸  ê¸°íš ë° ì œì‘': icon = 'edit'; break;
      case 'ìº í˜ì¸ ì‹¤í–‰': icon = 'rocket_launch'; break;
      case 'ì„±ê³¼ ì¸¡ì • ë° ë¶„ì„': icon = 'analytics'; break;
      case 'ì½˜í…ì¸  í™•ì¥ ë° ìµœì í™”': icon = 'auto_awesome'; break;
      case 'ê³ ê° ì»¤ë®¤ë‹ˆì¼€ì´ì…˜': icon = 'chat'; break;
      case 'ê°œì„  ë° ë°˜ë³µ': icon = 'loop'; break;
      case 'ë°ì´í„° ê´€ë¦¬ ë° ì •ë¦¬': icon = 'folder_open'; break;
      case 'ì„±ê³¼ ê³µìœ  ë° ë‹¤ìŒ ìŠ¤í…': icon = 'celebration'; break;
      default: icon = 'category';
    }
    categoryTitleSpan.innerHTML = `<span class="material-icons">${icon}</span> ${categoryName}`;
    categoryHeader.appendChild(categoryTitleSpan);

    // ì¹´í…Œê³ ë¦¬ ì•¡ì…˜ ë²„íŠ¼ë“¤
    const categoryActions = document.createElement('div');
    categoryActions.className = 'category-actions';

    // ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ë²„íŠ¼
    const editCategoryBtn = document.createElement('span');
    editCategoryBtn.className = 'material-icons edit-category-btn';
    editCategoryBtn.textContent = 'edit';
    editCategoryBtn.title = 'ì¹´í…Œê³ ë¦¬ ì´ë¦„ ìˆ˜ì •';
    editCategoryBtn.onclick = () => editCategory(categoryName);
    categoryActions.appendChild(editCategoryBtn);

    // ì¹´í…Œê³ ë¦¬ ì‚­ì œ ë²„íŠ¼
    const deleteCategoryBtn = document.createElement('span');
    deleteCategoryBtn.className = 'material-icons delete-category-btn';
    deleteCategoryBtn.textContent = 'close';
    deleteCategoryBtn.title = 'ì¹´í…Œê³ ë¦¬ ì‚­ì œ';
    deleteCategoryBtn.onclick = () => deleteCategory(categoryName);
    categoryActions.appendChild(deleteCategoryBtn);
    
    categoryHeader.appendChild(categoryActions); // ì•¡ì…˜ ë²„íŠ¼ ê·¸ë£¹ ì¶”ê°€
    
    categoryBox.appendChild(categoryHeader);

    // ê° ì¹´í…Œê³ ë¦¬ ë‚´ì˜ Day ì„¹ì…˜ë“¤ ì¶”ê°€
    categories[categoryName].forEach((item) => { // 'item'ì€ day, category, tasks, displayTitleì„ í¬í•¨
      const day = item.day;

      const daySection = document.createElement("section");
      daySection.className = "day-section";
      daySection.id = `day-${day}`;
      daySection.setAttribute("aria-labelledby", `day-header-${day}`);

      // Day í—¤ë” (Day íƒ€ì´í‹€ í…ìŠ¤íŠ¸ + ì˜¤ë¥¸ìª½ ì§„í–‰ë¥  í…ìŠ¤íŠ¸ + ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼)
      const dayHeader = document.createElement("h3");
      dayHeader.id = `day-header-${day}`;
      dayHeader.style.display = "flex";
      dayHeader.style.justifyContent = "space-between";
      dayHeader.style.alignItems = "center";

      // Day íƒ€ì´í‹€ (í¸ì§‘ ê°€ëŠ¥í•˜ë„ë¡)
      const dayTitle = document.createElement("span");
      dayTitle.className = "day-title-editable"; // ìƒˆ ìŠ¤íƒ€ì¼ í´ë˜ìŠ¤
      dayTitle.contentEditable = "true"; // í¸ì§‘ ê°€ëŠ¥
      dayTitle.textContent = item.displayTitle; // displayTitle ì‚¬ìš©
      dayTitle.setAttribute('data-day-id', day); // ë‚´ë¶€ ìˆ«ì day ê°’ì„ ë°ì´í„° ì†ì„±ìœ¼ë¡œ ì €ì¥

      // Day íƒ€ì´í‹€ í¸ì§‘ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      dayTitle.addEventListener('blur', function() {
          const currentDayNumber = parseInt(this.getAttribute('data-day-id'));
          const newDisplayTitle = this.textContent.trim();
          const dayObj = checklistData.find(d => d.day === currentDayNumber);
          if (dayObj && dayObj.displayTitle !== newDisplayTitle) {
              dayObj.displayTitle = newDisplayTitle;
              saveState();
              updateOverallProgress();
          }
      });
      dayTitle.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
              e.preventDefault(); // ìƒˆ ì¤„ ë°©ì§€
              this.blur(); // blur ì´ë²¤íŠ¸ ë°œìƒì‹œì¼œ ì €ì¥
          }
      });
      dayHeader.appendChild(dayTitle);

      const dayProgressText = document.createElement("span");
      dayProgressText.className = "day-progress-text";
      dayProgressText.textContent = "0% ì™„ë£Œ";

      const dayActions = document.createElement('div'); // Day ì•¡ì…˜ ë²„íŠ¼ë“¤ì„ ìœ„í•œ ì»¨í…Œì´ë„ˆ
      dayActions.className = 'day-actions';
      dayActions.appendChild(dayProgressText); // ì§„í–‰ë¥  í…ìŠ¤íŠ¸ ì¶”ê°€

      // Day ìˆ˜ì • ë²„íŠ¼ (Day íƒ€ì´í‹€ í¸ì§‘ì„ íŠ¸ë¦¬ê±°)
      const editDayBtn = document.createElement('span');
      editDayBtn.className = 'material-icons edit-day-btn';
      editDayBtn.textContent = 'edit';
      editDayBtn.title = 'Day íƒ€ì´í‹€ ìˆ˜ì •';
      editDayBtn.onclick = () => {
          const targetDayTitleSpan = daySection.querySelector('.day-title-editable');
          if (targetDayTitleSpan) {
              targetDayTitleSpan.focus();
              // ì»¤ì„œë¥¼ í…ìŠ¤íŠ¸ ëìœ¼ë¡œ ì´ë™
              const range = document.createRange();
              const sel = window.getSelection();
              range.selectNodeContents(targetDayTitleSpan);
              range.collapse(false); // ëìœ¼ë¡œ ì¶•ì†Œ
              sel.removeAllRanges();
              sel.addRange(range);
          }
      };
      dayActions.appendChild(editDayBtn);

      // Day ì‚­ì œ ë²„íŠ¼ (ì•„ì´ì½˜ ë³€ê²½)
      const deleteDayBtn = document.createElement('span');
      deleteDayBtn.className = 'material-icons delete-day-btn';
      deleteDayBtn.textContent = 'close';
      deleteDayBtn.title = 'Day ì‚­ì œ';
      deleteDayBtn.onclick = () => deleteDay(day);
      dayActions.appendChild(deleteDayBtn);

      dayHeader.appendChild(dayActions); // Day ì•¡ì…˜ ë²„íŠ¼ ê·¸ë£¹ ì¶”ê°€
      
      // Day ì§„í–‰ë¥  ë°”
      const dayProgressBarBg = document.createElement("div");
      dayProgressBarBg.className = "day-progress-bar-bg";
      const dayProgressBarFill = document.createElement("div");
      dayProgressBarFill.className = "day-progress-bar-fill";
      dayProgressBarFill.style.width = "0%";
      dayProgressBarBg.appendChild(dayProgressBarFill);

      daySection.appendChild(dayHeader);
      daySection.appendChild(dayProgressBarBg);

      const ul = document.createElement("ul");

      // ê° íƒœìŠ¤í¬ í•­ëª© ì¶”ê°€
      item.tasks.forEach((task) => { // i (index) ëŒ€ì‹  task.id ì‚¬ìš©
        const li = document.createElement("li");
        
        // 'í…ŒìŠ¤í¬ ì¶”ê°€' ë²„íŠ¼ (ì²´í¬ë°•ìŠ¤ ì™¼ìª½, í•­ìƒ í‘œì‹œ)
        // Material Icon ëŒ€ì‹  SVGë¡œ ë³€ê²½í•˜ì—¬ ê·¸ë¼ë°ì´ì…˜ ì ìš©
        const addTaskInlineBtn = document.createElement('button');
        addTaskInlineBtn.className = 'add-task-inline-btn';
        addTaskInlineBtn.title = 'ì´ íƒœìŠ¤í¬ ë‹¤ìŒì— ìƒˆë¡œìš´ íƒœìŠ¤í¬ ì¶”ê°€';
        addTaskInlineBtn.innerHTML = `
            <svg class="add-icon" viewBox="0 0 24 24">
                <defs>
                    <linearGradient id="addTaskGradient" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0%" stop-color="#34d399"/>
                        <stop offset="100%" stop-color="#059669"/>
                    </linearGradient>
                    <linearGradient id="addTaskGradientHover" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0%" stop-color="#059669"/>
                        <stop offset="100%" stop-color="#34d399"/>
                    </linearGradient>
                </defs>
                <path d="M12 4V20M20 12H4" stroke="url(#addTaskGradient)" stroke-width="2" stroke-linecap="round"/>
            </svg>
        `;
        addTaskInlineBtn.onclick = async () => {
            const newTaskContent = await showCustomModal("ìƒˆë¡œìš´ íƒœìŠ¤í¬ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”:", 'prompt', '');
            if (newTaskContent !== null && newTaskContent.trim() !== '') {
                addTaskToDay(categoryName, day, newTaskContent, task.id); // í˜„ì¬ íƒœìŠ¤í¬ ID ë‹¤ìŒì— ì¶”ê°€
            }
        };
        li.appendChild(addTaskInlineBtn);
        

        const label = document.createElement("label");
        const taskId = task.id; 
        label.setAttribute("for", taskId);

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = taskId;
        checkbox.checked = !!checklistState[taskId]; // ì €ì¥ëœ ìƒíƒœ ì ìš©

        const taskTextSpan = document.createElement("span"); // íƒœìŠ¤í¬ í…ìŠ¤íŠ¸ë¥¼ ë‹´ì„ span
        taskTextSpan.textContent = task.content; // task ê°ì²´ì˜ content ì†ì„± ì‚¬ìš©
        taskTextSpan.classList.add('task-text'); // í´ë˜ìŠ¤ ì¶”ê°€

        if (checkbox.checked) {
          label.classList.add("checked"); // ì²´í¬ëœ í•­ëª© ìŠ¤íƒ€ì¼ ì ìš©
        }

        // ì²´í¬ë°•ìŠ¤ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        checkbox.addEventListener("change", function() {
          checklistState[this.id] = this.checked; // ìƒíƒœ ì—…ë°ì´íŠ¸
          saveState(); // ìƒíƒœ ì €ì¥

          if (this.checked) {
            label.classList.add("checked");
          } else {
            label.classList.remove("checked");
          }

          updateDayProgress(day); // Day ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
          updateOverallProgress(); // ì „ì²´ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
          checkCategoryCompletionAndScroll(day); // ì¹´í…Œê³ ë¦¬ ì™„ë£Œ ì—¬ë¶€ í™•ì¸ ë° ìŠ¤í¬ë¡¤
        });

        label.appendChild(checkbox);
        label.appendChild(taskTextSpan); // íƒœìŠ¤í¬ í…ìŠ¤íŠ¸ span ì¶”ê°€
        
        li.appendChild(label);

        // íƒœìŠ¤í¬ ì•¡ì…˜ ë²„íŠ¼ë“¤ì„ ë‹´ì„ ì»¨í…Œì´ë„ˆ
        const taskActions = document.createElement('div');
        taskActions.className = 'task-actions';

        // íƒœìŠ¤í¬ ìˆ˜ì • ë²„íŠ¼ ì¶”ê°€
        const editTaskBtn = document.createElement('span');
        editTaskBtn.className = 'material-icons edit-task-btn';
        editTaskBtn.textContent = 'edit';
        editTaskBtn.title = 'íƒœìŠ¤í¬ ìˆ˜ì •';
        editTaskBtn.onclick = () => editTask(task.id, day, task.content); // IDì™€ content ì „ë‹¬
        taskActions.appendChild(editTaskBtn);


        // íƒœìŠ¤í¬ ì‚­ì œ ë²„íŠ¼ (ì•„ì´ì½˜ ë³€ê²½)
        const deleteTaskBtn = document.createElement('span');
        deleteTaskBtn.className = 'material-icons delete-task-btn';
        deleteTaskBtn.textContent = 'close';
        deleteTaskBtn.title = 'íƒœìŠ¤í¬ ì‚­ì œ';
        deleteTaskBtn.onclick = () => deleteTask(task.id, day); // IDì™€ dayNumber ì „ë‹¬
        taskActions.appendChild(deleteTaskBtn);

        li.appendChild(taskActions); // ì•¡ì…˜ ë²„íŠ¼ ì»¨í…Œì´ë„ˆë¥¼ liì— ì¶”ê°€

        ul.appendChild(li);
      });

      // Dayì— íƒœìŠ¤í¬ê°€ í•˜ë‚˜ë„ ì—†ì„ ê²½ìš°ì˜ 'ì²« íƒœìŠ¤í¬ ì¶”ê°€' ë²„íŠ¼
      if (item.tasks.length === 0) { // tasks.lengthë¡œ í™•ì¸
          const addFirstTaskBtn = document.createElement('button');
          addFirstTaskBtn.className = 'add-first-task-btn'; // ìƒˆ í´ë˜ìŠ¤ ì ìš©
          addFirstTaskBtn.textContent = 'â• ì²« íƒœìŠ¤í¬ ì¶”ê°€';
          addFirstTaskBtn.onclick = async () => {
              const newTaskContent = await showCustomModal("ì²« íƒœìŠ¤í¬ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”:", 'prompt', '');
              if (newTaskContent !== null && newTaskContent.trim() !== '') {
                  addTaskToDay(categoryName, day, newTaskContent); // ID ì—†ì´ ì¶”ê°€ (Dayì˜ ì²« íƒœìŠ¤í¬)
              }
          };
          // ì´ ë²„íŠ¼ì€ ulì˜ ìì‹ì´ ì•„ë‹ˆë¼ daySectionì˜ ì§ì ‘ì ì¸ ìì‹ìœ¼ë¡œ ì¶”ê°€
          daySection.appendChild(addFirstTaskBtn);
      }
      
      daySection.appendChild(ul);


      categoryBox.appendChild(daySection); // Day ì„¹ì…˜ì„ ì¹´í…Œê³ ë¦¬ ë°•ìŠ¤ì— ì¶”ê°€
      updateDayProgress(day); // Day ì§„í–‰ë¥  ì´ˆê¸° ì—…ë°ì´íŠ¸
    });

    // ì¹´í…Œê³ ë¦¬ì— Day ì¶”ê°€ ë²„íŠ¼
    const addDayButton = document.createElement('button');
    addDayButton.className = 'add-day-btn';
    addDayButton.textContent = 'â• Day ì¶”ê°€';
    addDayButton.onclick = async () => {
        const tasksInput = await showCustomModal("ìƒˆë¡œìš´ Dayì— ì¶”ê°€í•  íƒœìŠ¤í¬ë¥¼ ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ ì‚¬í•­):", 'prompt', '');
        const tasks = tasksInput ? tasksInput.split(',').map(content => ({ id: crypto.randomUUID(), content: content.trim() })).filter(t => t.content !== '') : [];
        addDayToCategory(categoryName, tasks);
    };
    categoryBox.appendChild(addDayButton);

    checklist.appendChild(categoryBox); // ì¹´í…Œê³ ë¦¬ ë°•ìŠ¤ë¥¼ ì „ì²´ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
  }

    // ì´ˆê¸° ë¡œë“œ ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì • (ìƒˆ ë¹ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„± ë²„íŠ¼ìœ¼ë¡œ ì´ë™)
    if (checklistData.length === 0) {
        createNewEmptyChecklist(false); // ì²˜ìŒ ë¡œë“œ ì‹œ ìë™ ìƒì„±, í™•ì¸ ë©”ì‹œì§€ ì—†ì´
    }
}

// ìƒˆ ë¹ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„± í•¨ìˆ˜
async function createNewEmptyChecklist(showAlert = true) {
    let confirmed = true;
    if (showAlert) {
        confirmed = await showCustomModal("ì •ë§ë¡œ ëª¨ë“  ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ê³  ìƒˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“œì‹œê² ìŠµë‹ˆê¹Œ?", 'confirm');
    }
    
    if (confirmed) {
        checklistData = []; // ëª¨ë“  ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„° ì´ˆê¸°í™”
        checklistState = {}; // ëª¨ë“  ì²´í¬ ìƒíƒœ ì´ˆê¸°í™”
        localStorage.removeItem(STORAGE_KEY_APP_TITLE); // ì•± íƒ€ì´í‹€ ì´ˆê¸°í™”
        appTitleElement.textContent = "ğŸ“… ë§ˆì¼€íŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸"; // ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
        saveState(); // ì €ì¥
        
        // ê¸°ë³¸ ë¹ˆ ì¹´í…Œê³ ë¦¬ ì¶”ê°€
        const defaultCategoryName = "ìƒˆë¡œìš´ ì¹´í…Œê³ ë¦¬";
        const defaultDayNumber = 1;
        checklistData.push({ day: defaultDayNumber, category: defaultCategoryName, tasks: [{ id: crypto.randomUUID(), content: "ìƒˆë¡œìš´ íƒœìŠ¤í¬ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”!" }], displayTitle: `ğŸ“… Day ${defaultDayNumber}` }); // Add displayTitle
        
        saveState(); // ìƒˆë¡œìš´ ê¸°ë³¸ ë°ì´í„° ì €ì¥
        buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
        updateOverallProgress(); // ì „ì²´ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        diagnosisResult.style.display = "none"; // ì§„ë‹¨ ê²°ê³¼ ìˆ¨ê¹€
        printResultBtn.style.display = "none"; // ì§„ë‹¨ ê²°ê³¼ ì¸ì‡„ ë²„íŠ¼ ìˆ¨ê¹€
        checklist.scrollTo({ left: 0, behavior: 'smooth' }); // ì¹´ë“œ ê°€ë¡œ ìŠ¤í¬ë¡¤ ë§¨ ì•ìœ¼ë¡œ
        setTimeout(() => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 80);
    }
}


// 'ì „ì²´ ì²´í¬ ì´ˆê¸°í™”' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
resetBtn.addEventListener("click", async () => {
  const confirmed = await showCustomModal("ëª¨ë“  ì²´í¬ í•­ëª©ì„ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?", 'confirm');
  if (confirmed) {
    checklistState = {}; // ìƒíƒœ ì´ˆê¸°í™”
    saveState(); // ì €ì¥
    buildChecklist(); // UI ë‹¤ì‹œ ê·¸ë¦¬ê¸°
    updateOverallProgress(); // ì „ì²´ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
    diagnosisResult.style.display = "none"; // ì§„ë‹¨ ê²°ê³¼ ìˆ¨ê¹€
    printResultBtn.style.display = "none"; // ì§„ë‹¨ ê²°ê³¼ ì¸ì‡„ ë²„íŠ¼ ìˆ¨ê¹€
    checklist.scrollTo({ left: 0, behavior: 'smooth' }); // ì¹´ë“œ ê°€ë¡œ ìŠ¤í¬ë¡¤ ë§¨ ì•ìœ¼ë¡œ

    setTimeout(() => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }, 80);
  }
});


// 'ì¸ì‡„ / PDF ì €ì¥' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ (ì²´í¬ë¦¬ìŠ¤íŠ¸ ì „ì²´ ì¸ì‡„)
printPdfBtn.addEventListener("click", () => {
  document.body.classList.remove("printing-result"); // ê²°ê³¼ë§Œ ì¸ì‡„ ëª¨ë“œ í•´ì œ
  window.print(); // ì¸ì‡„ ë‹¤ì´ì–¼ë¡œê·¸ í˜¸ì¶œ
});

// 'ì§„ë‹¨ ê²°ê³¼ ë³´ê¸°' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
showResultBtn.addEventListener("click", () => {
  const completedTasks = [];
  checklistData.forEach(({ category, day, tasks, displayTitle }) => { // displayTitle ì¶”ê°€
    tasks.forEach(task => { // task ê°ì²´ ì‚¬ìš©
      if (checklistState[task.id]) {
        completedTasks.push(`[${category}] ${displayTitle}: ${task.content}`); // displayTitle ì‚¬ìš©
      }
    });
  });

  const totalTasks = checklistData.reduce((acc, day) => acc + day.tasks.length, 0);
  const doneTasks = Object.values(checklistState).filter(v => v).length;
  const percent = totalTasks ? Math.round((doneTasks / totalTasks) * 100) : 0;

  summaryText.textContent = `ì´ ${totalTasks}ê°œ ì¤‘ ${doneTasks}ê°œ ì™„ë£Œ (${percent}%)`; // ìš”ì•½ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸

  completedTasksList.innerHTML = ""; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”
  if (completedTasks.length === 0) {
    completedTasksList.innerHTML = "<li>ì•„ì§ ì™„ë£Œëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</li>";
  } else {
    completedTasks.forEach(task => {
      const li = document.createElement("li");
      li.textContent = task;
      completedTasksList.appendChild(li); // ëª©ë¡ì— ì¶”ê°€
    });
  }

  diagnosisResult.style.display = "block"; // ì§„ë‹¨ ê²°ê³¼ í‘œì‹œ
  printResultBtn.style.display = "inline-block"; // ì§„ë‹¨ ê²°ê³¼ ì¸ì‡„ ë²„íŠ¼ í‘œì‹œ
  diagnosisResult.scrollIntoView({ behavior: "smooth" }); // ê²°ê³¼ ì˜ì—­ìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
});

// 'ì§„ë‹¨ ê²°ê³¼ë§Œ ì¸ì‡„/PDF' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
printResultBtn.addEventListener("click", function() {
  document.body.classList.add("printing-result"); // ê²°ê³¼ë§Œ ì¸ì‡„ ëª¨ë“œ ì„¤ì •
  window.print(); // ì¸ì‡„ ë‹¤ì´ì–¼ë¡œê·¸ í˜¸ì¶œ
  // ì¸ì‡„ê°€ ì™„ë£Œë˜ë©´ í´ë˜ìŠ¤ ì œê±° (ì¸ì‡„ í›„ ì›ë˜ ìŠ¤íƒ€ì¼ë¡œ ëŒì•„ì˜¤ë„ë¡)
  setTimeout(() => {
    document.body.classList.remove("printing-result");
  }, 1000);
});

// ì•± íƒ€ì´í‹€ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
appTitleElement.addEventListener('blur', () => {
    saveState();
});
appTitleElement.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        e.preventDefault(); // ìƒˆ ì¤„ ë°©ì§€
        appTitleElement.blur(); // í¬ì»¤ìŠ¤ ìƒê²Œ í•˜ì—¬ ì €ì¥ íŠ¸ë¦¬ê±°
    }
});


// ìƒˆ ë¹ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„± ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
newEmptyChecklistBtn.addEventListener("click", () => createNewEmptyChecklist(true)); // ëª…ì‹œì ìœ¼ë¡œ true ì „ë‹¬

// ì €ì¥ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
saveAllBtn.addEventListener("click", () => {
    saveState();
    showCustomModal("í˜„ì¬ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒíƒœê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.", "alert");
});


// í˜ì´ì§€ ë¡œë“œ ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¹Œë“œ ë° ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
loadState(); // ì €ì¥ëœ ë°ì´í„° ë° ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸°
buildChecklist();
updateOverallProgress();
// ì´ˆê¸° í™”ì‚´í‘œ ë²„íŠ¼ ê°€ì‹œì„± ì„¤ì • ë° ìœ„ì¹˜ ì—…ë°ì´íŠ¸
updateArrowButtonVisibility();

//ì–‘í™”ì‚´í‘œ ë”°ë¼ì˜¤ê¸°

let currentTranslateY = 0;

function lerp(start, end, t) {
  return start * (1 - t) + end * t;
}

function update() {
  const scrollY = window.scrollY || window.pageYOffset;
  const docHeight = document.documentElement.scrollHeight - window.innerHeight;
  const scrollRatio = docHeight > 0 ? scrollY / docHeight : 0;
  const moveRange = window.innerHeight * 0.6; // 0.6~0.7 ì •ë„ê°€ ì ë‹¹

  const targetTranslateY = (scrollRatio - 0.5) * moveRange;

  // ë¶€ë“œëŸ½ê²Œ ë”°ë¼ì˜¤ê²Œ ë³´ê°„
  currentTranslateY = lerp(currentTranslateY, targetTranslateY, 0.13);

  document.querySelectorAll('.scroll-button').forEach(btn => {
   
  });

  requestAnimationFrame(update);
}

requestAnimationFrame(update);

const currentUrl = window.location.href;
const pageTitle = document.title;


// ì¹´ì¹´ì˜¤í†¡ ê³µìœ  (ëª¨ë°”ì¼ì—ì„œë§Œ ë™ì‘, PCì—ì„œëŠ” ì•ˆë‚´)
document.getElementById('btn-kakaotalk').onclick = async function(e) {
  e.preventDefault();
  const kakaoUrl = `kakao://send?text=${encodeURIComponent(pageTitle)}%0A${encodeURIComponent(currentUrl)}`;
  if (/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
    window.location.href = kakaoUrl;
  } else {
    await showCustomModal('ì¹´ì¹´ì˜¤í†¡ ê³µìœ ëŠ” ëª¨ë°”ì¼ì—ì„œë§Œ ì§€ì›ë©ë‹ˆë‹¤.', 'alert');
  }
};

// Web Share API (ì§€ì› ë¸Œë¼ìš°ì €)
document.getElementById('btn-webshare').onclick = async function() {
  if (navigator.share) {
    navigator.share({
      title: pageTitle,
      url: currentUrl
    }).catch(() => {});
  } else {
    if (navigator.clipboard) {
      await navigator.clipboard.writeText(currentUrl);
      await showCustomModal('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'alert');
    } else {
      await showCustomModal('ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•˜ì„¸ìš”', 'prompt', currentUrl);
    }
  }
};

//ë‹¤ìš´ë¡œë“œ
document.getElementById('btn-download').onclick = function() {
  const source = document.documentElement.outerHTML;
  const blob = new Blob([source], {type: "text/html"});
  const url = URL.createObjectURL(blob);

  const anchor = document.createElement('a');
  anchor.href = url;
  anchor.download = 'ë§ˆì¼€íŒ…_30ì¼_ì²´í¬ë¦¬ìŠ¤íŠ¸.html';
  document.body.appendChild(anchor);
  anchor.click();
  document.body.removeChild(anchor);
  URL.revokeObjectURL(url);
};

</script>
</body>
</html>
